2025-07-30T19:31:24.000000000Z [info] Starting Container
2025-07-30T19:31:25.466204685Z [error] npm warn config production Use `--omit=dev` instead.
2025-07-30T19:31:25.466220693Z [info] 
2025-07-30T19:31:25.466233535Z [info] > shadow-accord-backend@0.3.0 start
2025-07-30T19:31:25.466244141Z [info] > node server.js
2025-07-30T19:31:25.466254067Z [info] 
2025-07-30T19:31:25.466267634Z [info] Shadow Accord Backend running on port 8080
2025-07-30T19:31:25.466281736Z [info] Environment: production
2025-07-30T19:31:25.466295989Z [info] MongoDB connected successfully
2025-07-30T19:34:55.490559166Z [info] 50.47.84.24 - - [30/Jul/2025:19:34:53 +0000] "GET /api/characters HTTP/1.1" 304 - "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:34:55.490601524Z [info] 50.47.84.24 - - [30/Jul/2025:19:34:53 +0000] "GET /api/characters HTTP/1.1" 304 - "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:00.744872534Z [info] Character update request: {
2025-07-30T19:35:00.744896350Z [info]   characterId: '688a71048d4e84fdb08b3d8b',
2025-07-30T19:35:00.744913263Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:00.744929998Z [info]   bodyKeys: [
2025-07-30T19:35:00.744946791Z [info]     'stats',                '_id',
2025-07-30T19:35:00.744959518Z [info]     'userId',               'name',
2025-07-30T19:35:00.744971282Z [info]     'player',               'faction',
2025-07-30T19:35:00.744981797Z [info]     'subfaction',           'skills',
2025-07-30T19:35:00.744996267Z [info]     'powers',               'merits',
2025-07-30T19:35:00.745005222Z [info] üîç Processing selectedPassions: object Array with 0 items
2025-07-30T19:35:00.745010762Z [info]     'lores',                'totalXP',
2025-07-30T19:35:00.745022877Z [info]     'xpSpent',              'checkInCount',
2025-07-30T19:35:00.745034335Z [info]     'xpHistory',            'advancementHistory',
2025-07-30T19:35:00.745042470Z [info] ‚úÖ After processing selectedPassions: object Array with 0 items
2025-07-30T19:35:00.745047442Z [info]     'innateTreeIds',        'fundamentalPowers',
2025-07-30T19:35:00.745061111Z [info]     'shadowArchetype',      'thornOptions',
2025-07-30T19:35:00.745067251Z [info] üîç Processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:00.745073116Z [info]     'selectedPassions',     'generation',
2025-07-30T19:35:00.745089926Z [info] ‚úÖ After processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:00.745093846Z [info]     'amaranthCount',        'breed',
2025-07-30T19:35:00.745106624Z [info]     'auspice',              'guild',
2025-07-30T19:35:00.745111614Z [info] üîç Processing selfNerfs: object Array with 0 items
2025-07-30T19:35:00.745122495Z [info]     'claimedStatus',        'selectedFomoriTree',
2025-07-30T19:35:00.745133451Z [info] ‚úÖ After processing selfNerfs: object Array with 0 items
2025-07-30T19:35:00.745135893Z [info]     'claimedInnateTreeIds', 'selfNerfs',
2025-07-30T19:35:00.745171917Z [info]     'notes',                'isPublic',
2025-07-30T19:35:00.745185501Z [info]     'campaignId',           'version',
2025-07-30T19:35:00.745198080Z [info] üîç Processing sharedWith: object Array with 0 items
2025-07-30T19:35:00.745199489Z [info]     'lastModified',         'sharedWith',
2025-07-30T19:35:00.745217631Z [info]     'factionChanges',       'createdAt',
2025-07-30T19:35:00.745219577Z [info] ‚úÖ After processing sharedWith: object Array with 0 items
2025-07-30T19:35:00.745234637Z [info]     'updatedAt',            '__v',
2025-07-30T19:35:00.745239924Z [info] üîç Processing factionChanges: object Array with 0 items
2025-07-30T19:35:00.745249819Z [info]     'id'
2025-07-30T19:35:00.745257364Z [info] ‚úÖ After processing factionChanges: object Array with 0 items
2025-07-30T19:35:00.745266221Z [info]   ],
2025-07-30T19:35:00.745344658Z [info] üîç Processing object stats: object
2025-07-30T19:35:00.745387682Z [info] ‚úÖ After processing object stats: object
2025-07-30T19:35:00.745408407Z [info] üîç Processing object skills: object
2025-07-30T19:35:00.745427824Z [info] ‚úÖ After processing object skills: object
2025-07-30T19:35:00.745446358Z [info] üîç Processing object powers: object
2025-07-30T19:35:00.745462884Z [info] ‚úÖ After processing object powers: object
2025-07-30T19:35:00.745480423Z [info] üîç Processing object merits: object
2025-07-30T19:35:00.745495347Z [info] ‚úÖ After processing object merits: object
2025-07-30T19:35:00.745797868Z [info]   hasStats: true,
2025-07-30T19:35:00.745818782Z [info]   hasSkills: true,
2025-07-30T19:35:00.745833691Z [info]   hasPowers: true,
2025-07-30T19:35:00.745846744Z [info]   hasMerits: true,
2025-07-30T19:35:00.745859826Z [info]   hasLores: true,
2025-07-30T19:35:00.745874517Z [info]   hasAdvancementHistory: true,
2025-07-30T19:35:00.745894681Z [info]   advancementHistoryType: 'object',
2025-07-30T19:35:00.745928316Z [info]   advancementHistoryValue: '[{checkIn:0,type:"skill",itemId:"armory",level:1,cost:2,timestamp:"2025-07-30T19:35:01.796Z",redundant:false}]...',
2025-07-30T19:35:00.745948731Z [info]   totalXP: 25,
2025-07-30T19:35:00.745962734Z [info]   xpSpent: 2
2025-07-30T19:35:00.745979175Z [info] }
2025-07-30T19:35:00.746001391Z [info] üîç Processing advancementHistory: object Array with 1 items
2025-07-30T19:35:00.746019847Z [info] ‚úÖ After processing advancementHistory: object Array with 1 items
2025-07-30T19:35:00.746035468Z [info] üîç Processing xpHistory: object Array with 1 items
2025-07-30T19:35:00.746052770Z [info] ‚úÖ After processing xpHistory: object Array with 1 items
2025-07-30T19:35:00.746070267Z [info] üîç Processing lores: object Array with 0 items
2025-07-30T19:35:00.746086119Z [info] ‚úÖ After processing lores: object Array with 0 items
2025-07-30T19:35:00.746105281Z [info] üîç Processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:00.746122985Z [info] ‚úÖ After processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:00.746137464Z [info] üîç Processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:00.746149827Z [info] ‚úÖ After processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:00.746162384Z [info] üîç Processing thornOptions: object Array with 0 items
2025-07-30T19:35:00.746176713Z [info] ‚úÖ After processing thornOptions: object Array with 0 items
2025-07-30T19:35:00.749210828Z [info] üìù Directly assigned stats: object
2025-07-30T19:35:00.752274283Z [info] üìù Directly assigned skills: object
2025-07-30T19:35:00.752292734Z [info] üìù Directly assigned powers: object
2025-07-30T19:35:00.752309221Z [info] üìù Directly assigned merits: object
2025-07-30T19:35:00.752325416Z [info] üìù Directly assigned lores: Array[0]
2025-07-30T19:35:00.752344306Z [info] üìù Directly assigned xpHistory: Array[1]
2025-07-30T19:35:00.752358421Z [info] üîç Before assignment - character.advancementHistory: Array[0] 
2025-07-30T19:35:00.752370076Z [info] üîç Value to assign: Array[1]
2025-07-30T19:35:00.752383275Z [info] üßπ Repairing corrupted advancementHistory field in database
2025-07-30T19:35:00.764288568Z [error] Character update error: CastError: Cast to [string] failed for value "[\n' +
2025-07-30T19:35:00.764312176Z [error]   '  {\n' +
2025-07-30T19:35:00.764328098Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:00.764342991Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:00.764359650Z [error]   "    itemId: 'armory',\n" +
2025-07-30T19:35:00.764372848Z [error]   '    level: 1,\n' +
2025-07-30T19:35:00.764387559Z [error]   '    cost: 2,\n' +
2025-07-30T19:35:00.764402657Z [error]   "    timestamp: '2025-07-30T19:35:01.796Z',\n" +
2025-07-30T19:35:00.764418230Z [error]   '    redundant: false\n' +
2025-07-30T19:35:00.764432125Z [error]   '  }\n' +
2025-07-30T19:35:00.764450404Z [error]   ']" (type string) at path "advancementHistory.0" because of "CastError"
2025-07-30T19:35:00.764467061Z [error]     at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:414:15)
2025-07-30T19:35:00.764483975Z [error]     at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:00.764500847Z [error]     at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:00.764515833Z [error]     at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:00.764530716Z [error]     at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:00.764546536Z [error]     at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:00.764570631Z [error]     at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:00.764587230Z [error]     at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23)
2025-07-30T19:35:00.764604119Z [error]     at model.Query.exec (/app/node_modules/mongoose/lib/query.js:4604:80)
2025-07-30T19:35:00.764620318Z [error]     at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-07-30T19:35:00.765082667Z [error]   stringValue: `"[\\n' +\n` +
2025-07-30T19:35:00.765097210Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:00.765111719Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:00.765127104Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:00.765143265Z [error]     `  "    itemId: 'armory',\\n" +\n` +
2025-07-30T19:35:00.765206161Z [error]     "  '    level: 1,\\n' +\n" +
2025-07-30T19:35:00.765221950Z [error]     "  '    cost: 2,\\n' +\n" +
2025-07-30T19:35:00.765239613Z [error]     `  "    timestamp: '2025-07-30T19:35:01.796Z',\\n" +\n` +
2025-07-30T19:35:00.765255176Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:00.765270420Z [error]     "  '  }\\n' +\n" +
2025-07-30T19:35:00.765284402Z [error]     `  ']"`,
2025-07-30T19:35:00.765299021Z [error]   messageFormat: undefined,
2025-07-30T19:35:00.765315600Z [error]   kind: '[string]',
2025-07-30T19:35:00.765329060Z [error]   value: '[\n' +
2025-07-30T19:35:00.765366343Z [error]     '  {\n' +
2025-07-30T19:35:00.765383665Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:00.765398293Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:00.765413538Z [error]     "    itemId: 'armory',\n" +
2025-07-30T19:35:00.765428564Z [error]     '    level: 1,\n' +
2025-07-30T19:35:00.765443220Z [error]     '    cost: 2,\n' +
2025-07-30T19:35:00.765458609Z [error]     "    timestamp: '2025-07-30T19:35:01.796Z',\n" +
2025-07-30T19:35:00.765473149Z [error]     '    redundant: false\n' +
2025-07-30T19:35:00.765486929Z [error]     '  }\n' +
2025-07-30T19:35:00.765501071Z [error]     ']',
2025-07-30T19:35:00.765516274Z [error]   path: 'advancementHistory.0',
2025-07-30T19:35:00.765531906Z [error]   reason: CastError: Cast to string failed for value "{
2025-07-30T19:35:00.765545889Z [error]     checkIn: 0,
2025-07-30T19:35:00.765561233Z [error]     type: 'skill',
2025-07-30T19:35:00.765575373Z [error]     itemId: 'armory',
2025-07-30T19:35:00.765634231Z [error]     level: 1,
2025-07-30T19:35:00.765648534Z [error]     cost: 2,
2025-07-30T19:35:00.765664366Z [error]     timestamp: '2025-07-30T19:35:01.796Z',
2025-07-30T19:35:00.765678692Z [error]     redundant: false
2025-07-30T19:35:00.765695058Z [error]   }" (type Object) at path "advancementHistory"
2025-07-30T19:35:00.765711720Z [error]       at SchemaString.cast (/app/node_modules/mongoose/lib/schema/string.js:607:11)
2025-07-30T19:35:00.765726873Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:00.765742745Z [error]       at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:410:32)
2025-07-30T19:35:00.765758155Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:00.765775750Z [error]       at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:00.765793039Z [error]       at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:00.765809707Z [error]       at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:00.765827659Z [error]       at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:00.765846233Z [error]       at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:00.765862732Z [error]       at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23) {
2025-07-30T19:35:00.765877252Z [error]     stringValue: '"{\n' +
2025-07-30T19:35:00.765891187Z [error]       '  checkIn: 0,\n' +
2025-07-30T19:35:00.765908378Z [error]       "  type: 'skill',\n" +
2025-07-30T19:35:00.765923225Z [error]       "  itemId: 'armory',\n" +
2025-07-30T19:35:00.765938039Z [error]       '  level: 1,\n' +
2025-07-30T19:35:00.765953051Z [error]       '  cost: 2,\n' +
2025-07-30T19:35:00.766087282Z [error]       "  timestamp: '2025-07-30T19:35:01.796Z',\n" +
2025-07-30T19:35:00.766102710Z [error]       '  redundant: false\n' +
2025-07-30T19:35:00.766116664Z [error]       '}"',
2025-07-30T19:35:00.766130999Z [error]     messageFormat: undefined,
2025-07-30T19:35:00.766144804Z [error]     kind: 'string',
2025-07-30T19:35:00.766157326Z [error]     value: {
2025-07-30T19:35:00.766170705Z [error]       checkIn: 0,
2025-07-30T19:35:00.766185636Z [error]       type: 'skill',
2025-07-30T19:35:00.766201096Z [error]       itemId: 'armory',
2025-07-30T19:35:00.766217376Z [error]       level: 1,
2025-07-30T19:35:00.766231504Z [error]       cost: 2,
2025-07-30T19:35:00.766245970Z [error]       timestamp: '2025-07-30T19:35:01.796Z',
2025-07-30T19:35:00.766260587Z [error]       redundant: false
2025-07-30T19:35:00.766275137Z [error]     },
2025-07-30T19:35:00.766290119Z [error]     path: 'advancementHistory',
2025-07-30T19:35:00.766307559Z [error]     reason: null,
2025-07-30T19:35:00.766324133Z [error]     valueType: 'Object'
2025-07-30T19:35:00.766337820Z [error]   },
2025-07-30T19:35:00.766358561Z [error]   valueType: 'string'
2025-07-30T19:35:00.766371854Z [error] }
2025-07-30T19:35:00.766403596Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:00 +0000] "PUT /api/characters/688a71048d4e84fdb08b3d8b HTTP/1.1" 500 61 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:00.834407466Z [info]   hasStats: true,
2025-07-30T19:35:00.834436286Z [info]   hasSkills: true,
2025-07-30T19:35:00.834458625Z [info]   hasPowers: true,
2025-07-30T19:35:00.834475154Z [info]   hasMerits: true,
2025-07-30T19:35:00.834489003Z [info]   hasLores: true,
2025-07-30T19:35:00.834507516Z [info]   hasAdvancementHistory: true,
2025-07-30T19:35:00.834524629Z [info]   advancementHistoryType: 'object',
2025-07-30T19:35:00.834559747Z [info]   advancementHistoryValue: '[{checkIn:0,type:"skill",itemId:"armory",level:1,cost:2,timestamp:"2025-07-30T19:35:02.229Z",redundant:false}]...',
2025-07-30T19:35:00.834578973Z [info]   totalXP: 25,
2025-07-30T19:35:00.834595829Z [info]   xpSpent: 2
2025-07-30T19:35:00.834611408Z [info] }
2025-07-30T19:35:00.834632515Z [info] üîç Processing advancementHistory: object Array with 1 items
2025-07-30T19:35:00.834669697Z [info] ‚úÖ After processing advancementHistory: object Array with 1 items
2025-07-30T19:35:00.834693020Z [info] üîç Processing xpHistory: object Array with 1 items
2025-07-30T19:35:00.834710355Z [info] ‚úÖ After processing xpHistory: object Array with 1 items
2025-07-30T19:35:00.834727230Z [info] üîç Processing lores: object Array with 0 items
2025-07-30T19:35:00.834744563Z [info] ‚úÖ After processing lores: object Array with 0 items
2025-07-30T19:35:00.834763351Z [info] üîç Processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:00.834784910Z [info] ‚úÖ After processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:00.834804710Z [info] üîç Processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:00.834825425Z [info] ‚úÖ After processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:00.834842597Z [info] üîç Processing thornOptions: object Array with 0 items
2025-07-30T19:35:00.834860433Z [info] ‚úÖ After processing thornOptions: object Array with 0 items
2025-07-30T19:35:00.834878129Z [info] üìù Directly assigned skills: object
2025-07-30T19:35:00.834884564Z [info] üîç Processing selectedPassions: object Array with 0 items
2025-07-30T19:35:00.834907426Z [info] Character update request: {
2025-07-30T19:35:00.834908193Z [info] üìù Directly assigned powers: object
2025-07-30T19:35:00.834909264Z [info] ‚úÖ After processing selectedPassions: object Array with 0 items
2025-07-30T19:35:00.834926882Z [info]   characterId: '688a71048d4e84fdb08b3d8b',
2025-07-30T19:35:00.834931270Z [info] üìù Directly assigned merits: object
2025-07-30T19:35:00.834939770Z [info] üîç Processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:00.834945258Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:00.834955138Z [info] üìù Directly assigned lores: Array[0]
2025-07-30T19:35:00.834963280Z [info]   bodyKeys: [
2025-07-30T19:35:00.834965990Z [info] ‚úÖ After processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:00.834975278Z [info] üìù Directly assigned xpHistory: Array[1]
2025-07-30T19:35:00.834980761Z [info]     'stats',                '_id',
2025-07-30T19:35:00.834988149Z [info] üîç Processing selfNerfs: object Array with 0 items
2025-07-30T19:35:00.834996419Z [info] üîç Before assignment - character.advancementHistory: Array[0] 
2025-07-30T19:35:00.835014683Z [info] ‚úÖ After processing selfNerfs: object Array with 0 items
2025-07-30T19:35:00.835019116Z [info] üîç Value to assign: Array[1]
2025-07-30T19:35:00.835021779Z [info]     'userId',               'name',
2025-07-30T19:35:00.835041086Z [info] üîç Processing sharedWith: object Array with 0 items
2025-07-30T19:35:00.835045099Z [info]     'player',               'faction',
2025-07-30T19:35:00.835045157Z [info] üßπ Repairing corrupted advancementHistory field in database
2025-07-30T19:35:00.835063220Z [info] ‚úÖ After processing sharedWith: object Array with 0 items
2025-07-30T19:35:00.835082245Z [info] üîç Processing factionChanges: object Array with 0 items
2025-07-30T19:35:00.835102185Z [info] ‚úÖ After processing factionChanges: object Array with 0 items
2025-07-30T19:35:00.835125738Z [info]     'subfaction',           'skills',
2025-07-30T19:35:00.835129685Z [info] üîç Processing object stats: object
2025-07-30T19:35:00.835142874Z [info]     'powers',               'merits',
2025-07-30T19:35:00.835148880Z [info] ‚úÖ After processing object stats: object
2025-07-30T19:35:00.835160203Z [info]     'lores',                'totalXP',
2025-07-30T19:35:00.835166767Z [info] üîç Processing object skills: object
2025-07-30T19:35:00.835178733Z [info]     'xpSpent',              'checkInCount',
2025-07-30T19:35:00.835183900Z [info] ‚úÖ After processing object skills: object
2025-07-30T19:35:00.835196712Z [info]     'xpHistory',            'advancementHistory',
2025-07-30T19:35:00.835203666Z [info] üîç Processing object powers: object
2025-07-30T19:35:00.835214007Z [info]     'innateTreeIds',        'fundamentalPowers',
2025-07-30T19:35:00.835222217Z [info] ‚úÖ After processing object powers: object
2025-07-30T19:35:00.835230224Z [info]     'shadowArchetype',      'thornOptions',
2025-07-30T19:35:00.835242235Z [info] üîç Processing object merits: object
2025-07-30T19:35:00.835248209Z [info]     'selectedPassions',     'generation',
2025-07-30T19:35:00.835267006Z [info]     'amaranthCount',        'breed',
2025-07-30T19:35:00.835267634Z [info] ‚úÖ After processing object merits: object
2025-07-30T19:35:00.835289864Z [info]     'auspice',              'guild',
2025-07-30T19:35:00.835291468Z [info] üìù Directly assigned stats: object
2025-07-30T19:35:00.835309620Z [info]     'claimedStatus',        'selectedFomoriTree',
2025-07-30T19:35:00.835323605Z [info]     'claimedInnateTreeIds', 'selfNerfs',
2025-07-30T19:35:00.835338446Z [info]     'notes',                'isPublic',
2025-07-30T19:35:00.835352194Z [info]     'campaignId',           'version',
2025-07-30T19:35:00.835364545Z [info]     'lastModified',         'sharedWith',
2025-07-30T19:35:00.835378814Z [info]     'factionChanges',       'createdAt',
2025-07-30T19:35:00.835389649Z [info]     'updatedAt',            '__v',
2025-07-30T19:35:00.835400511Z [info]     'id'
2025-07-30T19:35:00.835410711Z [info]   ],
2025-07-30T19:35:00.840408758Z [error] Character update error: CastError: Cast to [string] failed for value "[\n' +
2025-07-30T19:35:00.840427674Z [error]       "  timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:00.840433955Z [error]   '  {\n' +
2025-07-30T19:35:00.840449295Z [error]       '  redundant: false\n' +
2025-07-30T19:35:00.840452232Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:00.840467765Z [error]       '}"',
2025-07-30T19:35:00.840469499Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:00.840486769Z [error]   "    itemId: 'armory',\n" +
2025-07-30T19:35:00.840487571Z [error]     messageFormat: undefined,
2025-07-30T19:35:00.840504948Z [error]   '    level: 1,\n' +
2025-07-30T19:35:00.840505713Z [error]     kind: 'string',
2025-07-30T19:35:00.840518673Z [error]   '    cost: 2,\n' +
2025-07-30T19:35:00.840524366Z [error]     value: {
2025-07-30T19:35:00.840534759Z [error]   "    timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:00.840540803Z [error]       checkIn: 0,
2025-07-30T19:35:00.840550541Z [error]   '    redundant: false\n' +
2025-07-30T19:35:00.840557570Z [error]       type: 'skill',
2025-07-30T19:35:00.840567486Z [error]   '  }\n' +
2025-07-30T19:35:00.840574195Z [error]       itemId: 'armory',
2025-07-30T19:35:00.840588247Z [error]   ']" (type string) at path "advancementHistory.0" because of "CastError"
2025-07-30T19:35:00.840591301Z [error]       level: 1,
2025-07-30T19:35:00.840605514Z [error]     at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:414:15)
2025-07-30T19:35:00.840608428Z [error]       cost: 2,
2025-07-30T19:35:00.840625335Z [error]       timestamp: '2025-07-30T19:35:02.229Z',
2025-07-30T19:35:00.840626351Z [error]     at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:00.840640740Z [error]       redundant: false
2025-07-30T19:35:00.840645506Z [error]     at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:00.840658878Z [error]     },
2025-07-30T19:35:00.840664124Z [error]     at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:00.840673403Z [error]     path: 'advancementHistory',
2025-07-30T19:35:00.840680886Z [error]     at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:00.840689241Z [error]     reason: null,
2025-07-30T19:35:00.840698086Z [error]     at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:00.840705450Z [error]     valueType: 'Object'
2025-07-30T19:35:00.840718743Z [error]     at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:00.840721760Z [error]   },
2025-07-30T19:35:00.840736251Z [error]   valueType: 'string'
2025-07-30T19:35:00.840737502Z [error]     at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23)
2025-07-30T19:35:00.840754312Z [error] }
2025-07-30T19:35:00.840757967Z [error]     at model.Query.exec (/app/node_modules/mongoose/lib/query.js:4604:80)
2025-07-30T19:35:00.840774586Z [error]     at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-07-30T19:35:00.840808639Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:00 +0000] "PUT /api/characters/688a71048d4e84fdb08b3d8b HTTP/1.1" 500 61 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:00.841193798Z [error]   stringValue: `"[\\n' +\n` +
2025-07-30T19:35:00.841210863Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:00.841226781Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:00.841242004Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:00.841309436Z [error]     `  "    itemId: 'armory',\\n" +\n` +
2025-07-30T19:35:00.841324175Z [error]     "  '    level: 1,\\n' +\n" +
2025-07-30T19:35:00.841338832Z [error]     "  '    cost: 2,\\n' +\n" +
2025-07-30T19:35:00.841354394Z [error]     `  "    timestamp: '2025-07-30T19:35:02.229Z',\\n" +\n` +
2025-07-30T19:35:00.841370652Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:00.841386048Z [error]     "  '  }\\n' +\n" +
2025-07-30T19:35:00.841400342Z [error]     `  ']"`,
2025-07-30T19:35:00.841414413Z [error]   messageFormat: undefined,
2025-07-30T19:35:00.841429098Z [error]   kind: '[string]',
2025-07-30T19:35:00.841537190Z [error]   value: '[\n' +
2025-07-30T19:35:00.841558577Z [error]     '  {\n' +
2025-07-30T19:35:00.841577118Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:00.841592597Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:00.841607580Z [error]     "    itemId: 'armory',\n" +
2025-07-30T19:35:00.841627572Z [error]     '    level: 1,\n' +
2025-07-30T19:35:00.841642549Z [error]     '    cost: 2,\n' +
2025-07-30T19:35:00.841666085Z [error]     "    timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:00.841685475Z [error]     '    redundant: false\n' +
2025-07-30T19:35:00.841699744Z [error]     '  }\n' +
2025-07-30T19:35:00.841715562Z [error]     ']',
2025-07-30T19:35:00.841729802Z [error]   path: 'advancementHistory.0',
2025-07-30T19:35:00.841745041Z [error]   reason: CastError: Cast to string failed for value "{
2025-07-30T19:35:00.841758403Z [error]     checkIn: 0,
2025-07-30T19:35:00.841772897Z [error]     type: 'skill',
2025-07-30T19:35:00.841786592Z [error]     itemId: 'armory',
2025-07-30T19:35:00.841801891Z [error]     level: 1,
2025-07-30T19:35:00.841816820Z [error]     cost: 2,
2025-07-30T19:35:00.841832095Z [error]     timestamp: '2025-07-30T19:35:02.229Z',
2025-07-30T19:35:00.841846570Z [error]     redundant: false
2025-07-30T19:35:00.841866423Z [error]   }" (type Object) at path "advancementHistory"
2025-07-30T19:35:00.841882764Z [error]       at SchemaString.cast (/app/node_modules/mongoose/lib/schema/string.js:607:11)
2025-07-30T19:35:00.841900276Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:00.841917360Z [error]       at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:410:32)
2025-07-30T19:35:00.841936080Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:00.841955541Z [error]       at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:00.841975952Z [error]       at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:00.841996559Z [error]       at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:00.842015587Z [error]       at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:00.842033551Z [error]       at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:00.842053392Z [error]       at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23) {
2025-07-30T19:35:00.842069410Z [error]     stringValue: '"{\n' +
2025-07-30T19:35:00.842087095Z [error]       '  checkIn: 0,\n' +
2025-07-30T19:35:00.842104949Z [error]       "  type: 'skill',\n" +
2025-07-30T19:35:00.842122099Z [error]       "  itemId: 'armory',\n" +
2025-07-30T19:35:00.842138066Z [error]       '  level: 1,\n' +
2025-07-30T19:35:00.842154332Z [error]       '  cost: 2,\n' +
2025-07-30T19:35:01.413908708Z [info] Character update request: {
2025-07-30T19:35:01.413935279Z [info]   characterId: '688a71048d4e84fdb08b3d8b',
2025-07-30T19:35:01.413984456Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:01.414004895Z [info]   bodyKeys: [
2025-07-30T19:35:01.414023565Z [info]     'stats',                '_id',
2025-07-30T19:35:01.414041428Z [info]     'userId',               'name',
2025-07-30T19:35:01.414059296Z [info]     'player',               'faction',
2025-07-30T19:35:01.414076667Z [info]     'subfaction',           'skills',
2025-07-30T19:35:01.414093527Z [info]     'powers',               'merits',
2025-07-30T19:35:01.414111490Z [info]     'lores',                'totalXP',
2025-07-30T19:35:01.414128740Z [info]     'xpSpent',              'checkInCount',
2025-07-30T19:35:01.414145353Z [info]     'xpHistory',            'advancementHistory',
2025-07-30T19:35:01.414163832Z [info]     'innateTreeIds',        'fundamentalPowers',
2025-07-30T19:35:01.414180796Z [info]     'shadowArchetype',      'thornOptions',
2025-07-30T19:35:01.414195730Z [info]     'selectedPassions',     'generation',
2025-07-30T19:35:01.414210644Z [info]     'amaranthCount',        'breed',
2025-07-30T19:35:01.414227569Z [info]     'auspice',              'guild',
2025-07-30T19:35:01.414244010Z [info]     'claimedStatus',        'selectedFomoriTree',
2025-07-30T19:35:01.414260964Z [info]     'claimedInnateTreeIds', 'selfNerfs',
2025-07-30T19:35:01.414278471Z [info]     'notes',                'isPublic',
2025-07-30T19:35:01.414295510Z [info]     'campaignId',           'version',
2025-07-30T19:35:01.414312238Z [info]     'lastModified',         'sharedWith',
2025-07-30T19:35:01.414327339Z [info]     'factionChanges',       'createdAt',
2025-07-30T19:35:01.414344156Z [info]     'updatedAt',            '__v',
2025-07-30T19:35:01.414358975Z [info]     'id'
2025-07-30T19:35:01.414372977Z [info]   ],
2025-07-30T19:35:01.414771674Z [info]   hasStats: true,
2025-07-30T19:35:01.414785988Z [info]   hasSkills: true,
2025-07-30T19:35:01.414800188Z [info]   hasPowers: true,
2025-07-30T19:35:01.414814353Z [info]   hasMerits: true,
2025-07-30T19:35:01.414829210Z [info]   hasLores: true,
2025-07-30T19:35:01.414869008Z [info]   hasAdvancementHistory: true,
2025-07-30T19:35:01.414886310Z [info]   advancementHistoryType: 'object',
2025-07-30T19:35:01.414910806Z [info]   advancementHistoryValue: '[{checkIn:0,type:"skill",itemId:"armory",level:1,cost:2,timestamp:"2025-07-30T19:35:02.229Z",redundant:false},{checkIn:0,type:"skill",itemId:"armory",level:2,cost:4,"timestamp"...',
2025-07-30T19:35:01.414926555Z [info]   totalXP: 21,
2025-07-30T19:35:01.414941485Z [info]   xpSpent: 6
2025-07-30T19:35:01.414954760Z [info] }
2025-07-30T19:35:01.414971668Z [info] üîç Processing advancementHistory: object Array with 2 items
2025-07-30T19:35:01.414990813Z [info] ‚úÖ After processing advancementHistory: object Array with 2 items
2025-07-30T19:35:01.415006880Z [info] üîç Processing xpHistory: object Array with 2 items
2025-07-30T19:35:01.415022418Z [info] ‚úÖ After processing xpHistory: object Array with 2 items
2025-07-30T19:35:01.415039051Z [info] üîç Processing lores: object Array with 0 items
2025-07-30T19:35:01.415061611Z [info] ‚úÖ After processing lores: object Array with 0 items
2025-07-30T19:35:01.415082695Z [info] üîç Processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:01.415101354Z [info] ‚úÖ After processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:01.415115861Z [info] üîç Processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:01.415131383Z [info] ‚úÖ After processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:01.415146655Z [info] üîç Processing thornOptions: object Array with 0 items
2025-07-30T19:35:01.415163705Z [info] ‚úÖ After processing thornOptions: object Array with 0 items
2025-07-30T19:35:01.415179859Z [info] üîç Processing selectedPassions: object Array with 0 items
2025-07-30T19:35:01.415194115Z [info] ‚úÖ After processing selectedPassions: object Array with 0 items
2025-07-30T19:35:01.415209398Z [info] üîç Processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:01.415224914Z [info] ‚úÖ After processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:01.415239382Z [info] üîç Processing selfNerfs: object Array with 0 items
2025-07-30T19:35:01.415254201Z [info] ‚úÖ After processing selfNerfs: object Array with 0 items
2025-07-30T19:35:01.415270504Z [info] üîç Processing sharedWith: object Array with 0 items
2025-07-30T19:35:01.415288806Z [info] ‚úÖ After processing sharedWith: object Array with 0 items
2025-07-30T19:35:01.417884777Z [info] üîç Processing factionChanges: object Array with 0 items
2025-07-30T19:35:01.417904821Z [info] ‚úÖ After processing factionChanges: object Array with 0 items
2025-07-30T19:35:01.417920358Z [info] üîç Processing object stats: object
2025-07-30T19:35:01.417932556Z [info] ‚úÖ After processing object stats: object
2025-07-30T19:35:01.417944638Z [info] üîç Processing object skills: object
2025-07-30T19:35:01.417956144Z [info] ‚úÖ After processing object skills: object
2025-07-30T19:35:01.417968328Z [info] üîç Processing object powers: object
2025-07-30T19:35:01.417980752Z [info] ‚úÖ After processing object powers: object
2025-07-30T19:35:01.417992012Z [info] üîç Processing object merits: object
2025-07-30T19:35:01.418006343Z [info] ‚úÖ After processing object merits: object
2025-07-30T19:35:01.418020061Z [info] üìù Directly assigned stats: object
2025-07-30T19:35:01.418031781Z [info] üìù Directly assigned skills: object
2025-07-30T19:35:01.418045231Z [info] üìù Directly assigned powers: object
2025-07-30T19:35:01.418063518Z [info] üìù Directly assigned merits: object
2025-07-30T19:35:01.418076903Z [info] üìù Directly assigned lores: Array[0]
2025-07-30T19:35:01.418092213Z [info] üìù Directly assigned xpHistory: Array[2]
2025-07-30T19:35:01.418107613Z [info] üîç Before assignment - character.advancementHistory: Array[0] 
2025-07-30T19:35:01.418123806Z [info] üîç Value to assign: Array[2]
2025-07-30T19:35:01.418139410Z [info] üßπ Repairing corrupted advancementHistory field in database
2025-07-30T19:35:01.422256349Z [error] Character update error: CastError: Cast to [string] failed for value "[\n' +
2025-07-30T19:35:01.422273142Z [error]   '  {\n' +
2025-07-30T19:35:01.422289526Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:01.422306140Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:01.422321698Z [error]   "    itemId: 'armory',\n" +
2025-07-30T19:35:01.422337999Z [error]   '    level: 1,\n' +
2025-07-30T19:35:01.422353450Z [error]   '    cost: 2,\n' +
2025-07-30T19:35:01.422371036Z [error]   "    timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:01.422387529Z [error]   '    redundant: false\n' +
2025-07-30T19:35:01.422402380Z [error]   '  },\n' +
2025-07-30T19:35:01.422416481Z [error]   '  {\n' +
2025-07-30T19:35:01.422516992Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:01.422534855Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:01.422551182Z [error]   "    itemId: 'armory',\n" +
2025-07-30T19:35:01.422565879Z [error]   '    level: 2,\n' +
2025-07-30T19:35:01.422581036Z [error]   '    cost: 4,\n' +
2025-07-30T19:35:01.422599618Z [error]   "    timestamp: '2025-07-30T19:35:02.826Z',\n" +
2025-07-30T19:35:01.422614910Z [error]   '    redundant: false\n' +
2025-07-30T19:35:01.422630269Z [error]   '  }\n' +
2025-07-30T19:35:01.422650409Z [error]   ']" (type string) at path "advancementHistory.0" because of "CastError"
2025-07-30T19:35:01.422667599Z [error]     at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:414:15)
2025-07-30T19:35:01.422686193Z [error]     at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:01.422706600Z [error]     at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:01.422724932Z [error]     at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:01.422742446Z [error]     at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:01.423038711Z [error]       '  redundant: false\n' +
2025-07-30T19:35:01.423063254Z [error]       '}"',
2025-07-30T19:35:01.423082373Z [error]     messageFormat: undefined,
2025-07-30T19:35:01.423097114Z [error]     kind: 'string',
2025-07-30T19:35:01.423112700Z [error]     value: {
2025-07-30T19:35:01.423130417Z [error]       checkIn: 0,
2025-07-30T19:35:01.423146969Z [error]       type: 'skill',
2025-07-30T19:35:01.423162505Z [error]       itemId: 'armory',
2025-07-30T19:35:01.423177949Z [error]       level: 1,
2025-07-30T19:35:01.423195872Z [error]       cost: 2,
2025-07-30T19:35:01.423212218Z [error]       timestamp: '2025-07-30T19:35:02.229Z',
2025-07-30T19:35:01.423219752Z [error]     at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:01.423227280Z [error]       redundant: false
2025-07-30T19:35:01.423237699Z [error]     at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:01.423242977Z [error]     },
2025-07-30T19:35:01.423260305Z [error]     at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23)
2025-07-30T19:35:01.423261569Z [error]     path: 'advancementHistory',
2025-07-30T19:35:01.423279447Z [error]     reason: null,
2025-07-30T19:35:01.423281407Z [error]     at model.Query.exec (/app/node_modules/mongoose/lib/query.js:4604:80)
2025-07-30T19:35:01.423296193Z [error]     valueType: 'Object'
2025-07-30T19:35:01.423301559Z [error]     at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-07-30T19:35:01.423311161Z [error]   },
2025-07-30T19:35:01.423318067Z [error]   stringValue: `"[\\n' +\n` +
2025-07-30T19:35:01.423326250Z [error]   valueType: 'string'
2025-07-30T19:35:01.423334567Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:01.423340387Z [error] }
2025-07-30T19:35:01.423351253Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:01.423373196Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:01.423374273Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:01 +0000] "PUT /api/characters/688a71048d4e84fdb08b3d8b HTTP/1.1" 500 61 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:01.423391325Z [error]     `  "    itemId: 'armory',\\n" +\n` +
2025-07-30T19:35:01.423409794Z [error]     "  '    level: 1,\\n' +\n" +
2025-07-30T19:35:01.423426765Z [error]     "  '    cost: 2,\\n' +\n" +
2025-07-30T19:35:01.423444656Z [error]     `  "    timestamp: '2025-07-30T19:35:02.229Z',\\n" +\n` +
2025-07-30T19:35:01.423462872Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:01.423479098Z [error]     "  '  },\\n' +\n" +
2025-07-30T19:35:01.423494853Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:01.423512728Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:01.423528918Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:01.423545389Z [error]     `  "    itemId: 'armory',\\n" +\n` +
2025-07-30T19:35:01.423562596Z [error]     "  '    level: 2,\\n' +\n" +
2025-07-30T19:35:01.423579375Z [error]     "  '    cost: 4,\\n' +\n" +
2025-07-30T19:35:01.423597631Z [error]     `  "    timestamp: '2025-07-30T19:35:02.826Z',\\n" +\n` +
2025-07-30T19:35:01.423614509Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:01.423676566Z [error]     "  '  }\\n' +\n" +
2025-07-30T19:35:01.423712103Z [error]     `  ']"`,
2025-07-30T19:35:01.423731509Z [error]   messageFormat: undefined,
2025-07-30T19:35:01.423748154Z [error]   kind: '[string]',
2025-07-30T19:35:01.423764075Z [error]   value: '[\n' +
2025-07-30T19:35:01.423780350Z [error]     '  {\n' +
2025-07-30T19:35:01.423796896Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:01.423815115Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:01.423832349Z [error]     "    itemId: 'armory',\n" +
2025-07-30T19:35:01.423849454Z [error]     '    level: 1,\n' +
2025-07-30T19:35:01.423865274Z [error]     '    cost: 2,\n' +
2025-07-30T19:35:01.423882792Z [error]     "    timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:01.423900277Z [error]     '    redundant: false\n' +
2025-07-30T19:35:01.423916097Z [error]     '  },\n' +
2025-07-30T19:35:01.423931972Z [error]     '  {\n' +
2025-07-30T19:35:01.423948883Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:01.423966784Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:01.423982239Z [error]     "    itemId: 'armory',\n" +
2025-07-30T19:35:01.423998801Z [error]     '    level: 2,\n' +
2025-07-30T19:35:01.424013033Z [error]     '    cost: 4,\n' +
2025-07-30T19:35:01.424036378Z [error]     "    timestamp: '2025-07-30T19:35:02.826Z',\n" +
2025-07-30T19:35:01.424051916Z [error]     '    redundant: false\n' +
2025-07-30T19:35:01.424066864Z [error]     '  }\n' +
2025-07-30T19:35:01.424083364Z [error]     ']',
2025-07-30T19:35:01.424099499Z [error]   path: 'advancementHistory.0',
2025-07-30T19:35:01.424116950Z [error]   reason: CastError: Cast to string failed for value "{
2025-07-30T19:35:01.424133013Z [error]     checkIn: 0,
2025-07-30T19:35:01.424148133Z [error]     type: 'skill',
2025-07-30T19:35:01.424162868Z [error]     itemId: 'armory',
2025-07-30T19:35:01.424180721Z [error]     level: 1,
2025-07-30T19:35:01.424196124Z [error]     cost: 2,
2025-07-30T19:35:01.424212513Z [error]     timestamp: '2025-07-30T19:35:02.229Z',
2025-07-30T19:35:01.424227336Z [error]     redundant: false
2025-07-30T19:35:01.424245413Z [error]   }" (type Object) at path "advancementHistory"
2025-07-30T19:35:01.424264360Z [error]       at SchemaString.cast (/app/node_modules/mongoose/lib/schema/string.js:607:11)
2025-07-30T19:35:01.424282451Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:01.424300873Z [error]       at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:410:32)
2025-07-30T19:35:01.424319738Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:01.424337452Z [error]       at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:01.424358740Z [error]       at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:01.424376083Z [error]       at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:01.424393447Z [error]       at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:01.424411296Z [error]       at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:01.424429665Z [error]       at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23) {
2025-07-30T19:35:01.424444953Z [error]     stringValue: '"{\n' +
2025-07-30T19:35:01.424461011Z [error]       '  checkIn: 0,\n' +
2025-07-30T19:35:01.424476782Z [error]       "  type: 'skill',\n" +
2025-07-30T19:35:01.424492666Z [error]       "  itemId: 'armory',\n" +
2025-07-30T19:35:01.424515425Z [error]       '  level: 1,\n' +
2025-07-30T19:35:01.424530239Z [error]       '  cost: 2,\n' +
2025-07-30T19:35:01.424546972Z [error]       "  timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:01.829800052Z [info] Character update request: {
2025-07-30T19:35:01.829824855Z [info] üìù Directly assigned xpHistory: Array[3]
2025-07-30T19:35:01.829828683Z [info]   characterId: '688a71048d4e84fdb08b3d8b',
2025-07-30T19:35:01.829834377Z [info] üìù Directly assigned lores: Array[0]
2025-07-30T19:35:01.829844301Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:01.829851844Z [info] üîç Before assignment - character.advancementHistory: Array[0] 
2025-07-30T19:35:01.829857522Z [info]   bodyKeys: [
2025-07-30T19:35:01.829872431Z [info] üîç Value to assign: Array[3]
2025-07-30T19:35:01.829873666Z [info]     'stats',                '_id',
2025-07-30T19:35:01.829889089Z [info]     'userId',               'name',
2025-07-30T19:35:01.829894634Z [info] üßπ Repairing corrupted advancementHistory field in database
2025-07-30T19:35:01.829908733Z [info]     'player',               'faction',
2025-07-30T19:35:01.829932824Z [info]     'subfaction',           'skills',
2025-07-30T19:35:01.829954988Z [info]     'powers',               'merits',
2025-07-30T19:35:01.829968491Z [info]     'lores',                'totalXP',
2025-07-30T19:35:01.829981852Z [info]     'xpSpent',              'checkInCount',
2025-07-30T19:35:01.829994181Z [info]     'xpHistory',            'advancementHistory',
2025-07-30T19:35:01.830006644Z [info]     'innateTreeIds',        'fundamentalPowers',
2025-07-30T19:35:01.830018989Z [info]     'shadowArchetype',      'thornOptions',
2025-07-30T19:35:01.830030520Z [info]     'selectedPassions',     'generation',
2025-07-30T19:35:01.830042900Z [info]     'amaranthCount',        'breed',
2025-07-30T19:35:01.830057426Z [info]     'auspice',              'guild',
2025-07-30T19:35:01.830069852Z [info]     'claimedStatus',        'selectedFomoriTree',
2025-07-30T19:35:01.830082047Z [info]     'claimedInnateTreeIds', 'selfNerfs',
2025-07-30T19:35:01.830093749Z [info]     'notes',                'isPublic',
2025-07-30T19:35:01.830107951Z [info]     'campaignId',           'version',
2025-07-30T19:35:01.830122126Z [info]     'lastModified',         'sharedWith',
2025-07-30T19:35:01.830137179Z [info]     'factionChanges',       'createdAt',
2025-07-30T19:35:01.830151430Z [info]     'updatedAt',            '__v',
2025-07-30T19:35:01.830162652Z [info]     'id'
2025-07-30T19:35:01.830174472Z [info]   ],
2025-07-30T19:35:01.830707869Z [info]   hasStats: true,
2025-07-30T19:35:01.830725426Z [info]   hasSkills: true,
2025-07-30T19:35:01.830740621Z [info]   hasPowers: true,
2025-07-30T19:35:01.830755604Z [info]   hasMerits: true,
2025-07-30T19:35:01.830770947Z [info]   hasLores: true,
2025-07-30T19:35:01.830787997Z [info]   hasAdvancementHistory: true,
2025-07-30T19:35:01.830803764Z [info]   advancementHistoryType: 'object',
2025-07-30T19:35:01.830825974Z [info]   advancementHistoryValue: '[{checkIn:0,type:"skill",itemId:"armory",level:1,cost:2,timestamp:"2025-07-30T19:35:02.229Z",redundant:false},{checkIn:0,type:"skill",itemId:"armory",level:2,cost:4,"timestamp"...',
2025-07-30T19:35:01.830843271Z [info]   totalXP: 15,
2025-07-30T19:35:01.830857225Z [info]   xpSpent: 12
2025-07-30T19:35:01.830885502Z [info] }
2025-07-30T19:35:01.830904971Z [info] üîç Processing advancementHistory: object Array with 3 items
2025-07-30T19:35:01.830922244Z [info] ‚úÖ After processing advancementHistory: object Array with 3 items
2025-07-30T19:35:01.830938965Z [info] üîç Processing xpHistory: object Array with 3 items
2025-07-30T19:35:01.830955077Z [info] ‚úÖ After processing xpHistory: object Array with 3 items
2025-07-30T19:35:01.830971440Z [info] üîç Processing lores: object Array with 0 items
2025-07-30T19:35:01.830987860Z [info] ‚úÖ After processing lores: object Array with 0 items
2025-07-30T19:35:01.831008609Z [info] üîç Processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:01.831024576Z [info] ‚úÖ After processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:01.831040947Z [info] üîç Processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:01.831056593Z [info] ‚úÖ After processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:01.831073373Z [info] üîç Processing thornOptions: object Array with 0 items
2025-07-30T19:35:01.831091276Z [info] ‚úÖ After processing thornOptions: object Array with 0 items
2025-07-30T19:35:01.831155727Z [info] üîç Processing selectedPassions: object Array with 0 items
2025-07-30T19:35:01.831173438Z [info] ‚úÖ After processing selectedPassions: object Array with 0 items
2025-07-30T19:35:01.831189911Z [info] üîç Processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:01.831207472Z [info] ‚úÖ After processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:01.831223700Z [info] üîç Processing selfNerfs: object Array with 0 items
2025-07-30T19:35:01.831240473Z [info] ‚úÖ After processing selfNerfs: object Array with 0 items
2025-07-30T19:35:01.831260202Z [info] üîç Processing sharedWith: object Array with 0 items
2025-07-30T19:35:01.831276079Z [info] ‚úÖ After processing sharedWith: object Array with 0 items
2025-07-30T19:35:01.831292156Z [info] üîç Processing factionChanges: object Array with 0 items
2025-07-30T19:35:01.831308120Z [info] ‚úÖ After processing factionChanges: object Array with 0 items
2025-07-30T19:35:01.831324926Z [info] üîç Processing object stats: object
2025-07-30T19:35:01.831342098Z [info] ‚úÖ After processing object stats: object
2025-07-30T19:35:01.831356229Z [info] üîç Processing object skills: object
2025-07-30T19:35:01.831370346Z [info] ‚úÖ After processing object skills: object
2025-07-30T19:35:01.831387732Z [info] üîç Processing object powers: object
2025-07-30T19:35:01.831404439Z [info] ‚úÖ After processing object powers: object
2025-07-30T19:35:01.831421303Z [info] üîç Processing object merits: object
2025-07-30T19:35:01.831436062Z [info] ‚úÖ After processing object merits: object
2025-07-30T19:35:01.831452906Z [info] üìù Directly assigned stats: object
2025-07-30T19:35:01.831470739Z [info] üìù Directly assigned skills: object
2025-07-30T19:35:01.831603818Z [info] üìù Directly assigned powers: object
2025-07-30T19:35:01.831618590Z [info] üìù Directly assigned merits: object
2025-07-30T19:35:01.833671246Z [error] Character update error: CastError: Cast to [string] failed for value "[\n' +
2025-07-30T19:35:01.833693488Z [error]   '  {\n' +
2025-07-30T19:35:01.833709250Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:01.833723417Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:01.833739097Z [error]   "    itemId: 'armory',\n" +
2025-07-30T19:35:01.833741779Z [error]     "    timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:01.833753775Z [error]   '    level: 1,\n' +
2025-07-30T19:35:01.833762061Z [error]     '    redundant: false\n' +
2025-07-30T19:35:01.833768299Z [error]   '    cost: 2,\n' +
2025-07-30T19:35:01.833783450Z [error]     '  },\n' +
2025-07-30T19:35:01.833786860Z [error]   "    timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:01.833804719Z [error]   '    redundant: false\n' +
2025-07-30T19:35:01.833807143Z [error]     '  {\n' +
2025-07-30T19:35:01.833822316Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:01.833822696Z [error]   '  },\n' +
2025-07-30T19:35:01.833836129Z [error]   '  {\n' +
2025-07-30T19:35:01.833842540Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:01.833849623Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:01.833854572Z [error]     "    itemId: 'armory',\n" +
2025-07-30T19:35:01.833865378Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:01.833867504Z [error]     '    level: 2,\n' +
2025-07-30T19:35:01.833881567Z [error]     '    cost: 4,\n' +
2025-07-30T19:35:01.833883349Z [error]   "    itemId: 'armory',\n" +
2025-07-30T19:35:01.833898038Z [error]   '    level: 2,\n' +
2025-07-30T19:35:01.833905139Z [error]     "    timestamp: '2025-07-30T19:35:02.826Z',\n" +
2025-07-30T19:35:01.833912532Z [error]   '    cost: 4,\n' +
2025-07-30T19:35:01.833916813Z [error]     '    redundant: false\n' +
2025-07-30T19:35:01.833929822Z [error]   "    timestamp: '2025-07-30T19:35:02.826Z',\n" +
2025-07-30T19:35:01.833930157Z [error]     '  },\n' +
2025-07-30T19:35:01.833944139Z [error]     '  {\n' +
2025-07-30T19:35:01.833948253Z [error]   '    redundant: false\n' +
2025-07-30T19:35:01.833957209Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:01.833962019Z [error]   '  },\n' +
2025-07-30T19:35:01.833968668Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:01.833976289Z [error]   '  {\n' +
2025-07-30T19:35:01.833979984Z [error]     "    itemId: 'armory',\n" +
2025-07-30T19:35:01.833991152Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:01.833992750Z [error]     '    level: 3,\n' +
2025-07-30T19:35:01.834005695Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:01.834012128Z [error]     '    cost: 6,\n' +
2025-07-30T19:35:01.834021438Z [error]   "    itemId: 'armory',\n" +
2025-07-30T19:35:01.834027048Z [error]     "    timestamp: '2025-07-30T19:35:03.239Z',\n" +
2025-07-30T19:35:01.834037036Z [error]   '    level: 3,\n' +
2025-07-30T19:35:01.834043937Z [error]     '    redundant: false\n' +
2025-07-30T19:35:01.834054542Z [error]   '    cost: 6,\n' +
2025-07-30T19:35:01.834056246Z [error]     '  }\n' +
2025-07-30T19:35:01.834071398Z [error]   "    timestamp: '2025-07-30T19:35:03.239Z',\n" +
2025-07-30T19:35:01.834086042Z [error]   '    redundant: false\n' +
2025-07-30T19:35:01.834090075Z [error]     ']',
2025-07-30T19:35:01.834101801Z [error]   '  }\n' +
2025-07-30T19:35:01.834109201Z [error]   path: 'advancementHistory.0',
2025-07-30T19:35:01.834124869Z [error]   ']" (type string) at path "advancementHistory.0" because of "CastError"
2025-07-30T19:35:01.834129166Z [error]   reason: CastError: Cast to string failed for value "{
2025-07-30T19:35:01.834141477Z [error]     checkIn: 0,
2025-07-30T19:35:01.834152816Z [error]     type: 'skill',
2025-07-30T19:35:01.834164455Z [error]     itemId: 'armory',
2025-07-30T19:35:01.834176340Z [error]     level: 1,
2025-07-30T19:35:01.834189257Z [error]     cost: 2,
2025-07-30T19:35:01.834485191Z [error]     timestamp: '2025-07-30T19:35:02.229Z',
2025-07-30T19:35:01.834496590Z [error]     redundant: false
2025-07-30T19:35:01.834509114Z [error]   }" (type Object) at path "advancementHistory"
2025-07-30T19:35:01.834521352Z [error]       at SchemaString.cast (/app/node_modules/mongoose/lib/schema/string.js:607:11)
2025-07-30T19:35:01.834535187Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:01.834547878Z [error]       at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:410:32)
2025-07-30T19:35:01.834560877Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:01.834573531Z [error]       at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:01.834587412Z [error]       at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:01.834600235Z [error]       at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:01.834611166Z [error]     at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:414:15)
2025-07-30T19:35:01.834614418Z [error]       at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:01.834628971Z [error]       at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:01.834631277Z [error]     at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:01.834642147Z [error]       at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23) {
2025-07-30T19:35:01.834648947Z [error]     at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:01.834653432Z [error]     stringValue: '"{\n' +
2025-07-30T19:35:01.834667454Z [error]     at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:01.834671848Z [error]       '  checkIn: 0,\n' +
2025-07-30T19:35:01.834684320Z [error]       "  type: 'skill',\n" +
2025-07-30T19:35:01.834687382Z [error]     at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:01.834696511Z [error]       "  itemId: 'armory',\n" +
2025-07-30T19:35:01.834705085Z [error]     at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:01.834708639Z [error]       '  level: 1,\n' +
2025-07-30T19:35:01.834722268Z [error]       '  cost: 2,\n' +
2025-07-30T19:35:01.834724997Z [error]     at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:01.834740693Z [error]       "  timestamp: '2025-07-30T19:35:02.229Z',\n" +
2025-07-30T19:35:01.834748454Z [error]     at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23)
2025-07-30T19:35:01.834764530Z [error]     at model.Query.exec (/app/node_modules/mongoose/lib/query.js:4604:80)
2025-07-30T19:35:01.834782715Z [error]     at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-07-30T19:35:01.834808586Z [error]   stringValue: `"[\\n' +\n` +
2025-07-30T19:35:01.834824746Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:01.834841057Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:01.834850438Z [error]       '  redundant: false\n' +
2025-07-30T19:35:01.834856980Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:01.834860788Z [error]       '}"',
2025-07-30T19:35:01.834873401Z [error]     messageFormat: undefined,
2025-07-30T19:35:01.834875351Z [error]     `  "    itemId: 'armory',\\n" +\n` +
2025-07-30T19:35:01.834892405Z [error]     "  '    level: 1,\\n' +\n" +
2025-07-30T19:35:01.834895939Z [error]     kind: 'string',
2025-07-30T19:35:01.834908435Z [error]     value: {
2025-07-30T19:35:01.834909629Z [error]     "  '    cost: 2,\\n' +\n" +
2025-07-30T19:35:01.834930852Z [error]     `  "    timestamp: '2025-07-30T19:35:02.229Z',\\n" +\n` +
2025-07-30T19:35:01.834947773Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:01.834950833Z [error]       checkIn: 0,
2025-07-30T19:35:01.834964801Z [error]     "  '  },\\n' +\n" +
2025-07-30T19:35:01.834966356Z [error]       type: 'skill',
2025-07-30T19:35:01.834981492Z [error]       itemId: 'armory',
2025-07-30T19:35:01.834996284Z [error]       level: 1,
2025-07-30T19:35:01.835014356Z [error]       cost: 2,
2025-07-30T19:35:01.835029991Z [error]       timestamp: '2025-07-30T19:35:02.229Z',
2025-07-30T19:35:01.835044238Z [error]       redundant: false
2025-07-30T19:35:01.835067493Z [error]     },
2025-07-30T19:35:01.835086605Z [error]     path: 'advancementHistory',
2025-07-30T19:35:01.835097875Z [error]     reason: null,
2025-07-30T19:35:01.835109798Z [error]     valueType: 'Object'
2025-07-30T19:35:01.835121282Z [error]   },
2025-07-30T19:35:01.835131908Z [error]   valueType: 'string'
2025-07-30T19:35:01.835141877Z [error] }
2025-07-30T19:35:01.835162177Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:01 +0000] "PUT /api/characters/688a71048d4e84fdb08b3d8b HTTP/1.1" 500 61 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:01.835442078Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:01.835457422Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:01.835474718Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:01.835492170Z [error]     `  "    itemId: 'armory',\\n" +\n` +
2025-07-30T19:35:01.835507485Z [error]     "  '    level: 2,\\n' +\n" +
2025-07-30T19:35:01.835521382Z [error]     "  '    cost: 4,\\n' +\n" +
2025-07-30T19:35:01.835538241Z [error]     `  "    timestamp: '2025-07-30T19:35:02.826Z',\\n" +\n` +
2025-07-30T19:35:01.835552745Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:01.835567915Z [error]     "  '  },\\n' +\n" +
2025-07-30T19:35:01.835582449Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:01.835599461Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:01.835617314Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:01.835633910Z [error]     `  "    itemId: 'armory',\\n" +\n` +
2025-07-30T19:35:01.835649597Z [error]     "  '    level: 3,\\n' +\n" +
2025-07-30T19:35:01.835665991Z [error]     "  '    cost: 6,\\n' +\n" +
2025-07-30T19:35:01.835684446Z [error]     `  "    timestamp: '2025-07-30T19:35:03.239Z',\\n" +\n` +
2025-07-30T19:35:01.836037671Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:01.836056212Z [error]     "  '  }\\n' +\n" +
2025-07-30T19:35:01.836070525Z [error]     `  ']"`,
2025-07-30T19:35:01.836084449Z [error]   messageFormat: undefined,
2025-07-30T19:35:01.836099270Z [error]   kind: '[string]',
2025-07-30T19:35:01.836113824Z [error]   value: '[\n' +
2025-07-30T19:35:01.836126631Z [error]     '  {\n' +
2025-07-30T19:35:01.836141295Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:01.836155304Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:01.836187693Z [error]     "    itemId: 'armory',\n" +
2025-07-30T19:35:01.836206422Z [error]     '    level: 1,\n' +
2025-07-30T19:35:01.836221653Z [error]     '    cost: 2,\n' +
2025-07-30T19:35:31.866760872Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:31.866786404Z [info]   bodyKeys: [
2025-07-30T19:35:31.866805542Z [info]     'userId',             'name',
2025-07-30T19:35:31.866824381Z [info]     'player',             'faction',
2025-07-30T19:35:31.866841656Z [info]     'subfaction',         'stats',
2025-07-30T19:35:31.866860866Z [info]     'skills',             'powers',
2025-07-30T19:35:31.866876950Z [info]     'merits',             'lores',
2025-07-30T19:35:31.866894688Z [info]     'totalXP',            'xpSpent',
2025-07-30T19:35:31.866911346Z [info]     'checkInCount',       'xpHistory',
2025-07-30T19:35:31.866931040Z [info] üîç Processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:31.866932028Z [info]     'advancementHistory', 'innateTreeIds',
2025-07-30T19:35:31.866951520Z [info]     'fundamentalPowers',  'shadowArchetype',
2025-07-30T19:35:31.866968708Z [info] ‚úÖ After processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:31.866971474Z [info]     'thornOptions',       'selectedPassions',
2025-07-30T19:35:31.866990107Z [info]     'generation',         'amaranthCount',
2025-07-30T19:35:31.866994313Z [info] üîç Processing selfNerfs: object Array with 0 items
2025-07-30T19:35:31.867008075Z [info]     'breed',              'auspice',
2025-07-30T19:35:31.867013861Z [info] ‚úÖ After processing selfNerfs: object Array with 0 items
2025-07-30T19:35:31.867025023Z [info]     'guild',              'claimedStatus',
2025-07-30T19:35:31.867035983Z [info] üîç Processing sharedWith: object Array with 0 items
2025-07-30T19:35:31.867042329Z [info]     'selectedFomoriTree', 'claimedInnateTreeIds',
2025-07-30T19:35:31.867057121Z [info] ‚úÖ After processing sharedWith: object Array with 0 items
2025-07-30T19:35:31.867061500Z [info]     'selfNerfs',          'notes',
2025-07-30T19:35:31.867079953Z [info]     'isPublic',           'campaignId',
2025-07-30T19:35:31.867083074Z [info] üîç Processing factionChanges: object Array with 0 items
2025-07-30T19:35:31.867097671Z [info]     'version',            'lastModified',
2025-07-30T19:35:31.867103918Z [info] ‚úÖ After processing factionChanges: object Array with 0 items
2025-07-30T19:35:31.867114887Z [info]     '_id',                'sharedWith',
2025-07-30T19:35:31.867125877Z [info] üîç Processing object stats: object
2025-07-30T19:35:31.867130511Z [info]     'factionChanges',     'createdAt',
2025-07-30T19:35:31.867149919Z [info] ‚úÖ After processing object stats: object
2025-07-30T19:35:31.867150222Z [info]     'updatedAt',          '__v',
2025-07-30T19:35:31.867168804Z [info]     'id'
2025-07-30T19:35:31.867172165Z [info] üîç Processing object skills: object
2025-07-30T19:35:31.867172348Z [info] Character creation request received: {
2025-07-30T19:35:31.867184796Z [info]   ],
2025-07-30T19:35:31.867188465Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:31.867193424Z [info] ‚úÖ After processing object skills: object
2025-07-30T19:35:31.867204795Z [info]   body: {
2025-07-30T19:35:31.867207664Z [info]   hasStats: true,
2025-07-30T19:35:31.867215802Z [info] üîç Processing object powers: object
2025-07-30T19:35:31.867224252Z [info]     id: 1753904128234.3064,
2025-07-30T19:35:31.867226820Z [info]   hasSkills: true,
2025-07-30T19:35:31.867236070Z [info] ‚úÖ After processing object powers: object
2025-07-30T19:35:31.867243376Z [info]     name: 'test 1',
2025-07-30T19:35:31.867246797Z [info]   hasPowers: true,
2025-07-30T19:35:31.867254898Z [info] üîç Processing object merits: object
2025-07-30T19:35:31.867261683Z [info]     player: 't',
2025-07-30T19:35:31.867266485Z [info]   hasMerits: true,
2025-07-30T19:35:31.867281978Z [info] ‚úÖ After processing object merits: object
2025-07-30T19:35:31.867283442Z [info]     faction: 'human',
2025-07-30T19:35:31.867286291Z [info]   hasLores: true,
2025-07-30T19:35:31.867305919Z [info] üìù Directly assigned stats: object
2025-07-30T19:35:31.867306410Z [info]   hasAdvancementHistory: true,
2025-07-30T19:35:31.867308262Z [info]     subfaction: 'commoner',
2025-07-30T19:35:31.867328039Z [info]   advancementHistoryType: 'object',
2025-07-30T19:35:31.867328549Z [info]     clan: '',
2025-07-30T19:35:31.867346928Z [info]     breed: '',
2025-07-30T19:35:31.867354298Z [info]   advancementHistoryValue: '[{checkIn:0,type:"skill",itemId:"archery",level:1,cost:2,timestamp:"2025-07-30T19:35:32.123Z",redundant:false}]...',
2025-07-30T19:35:31.867368061Z [info]     auspice: '',
2025-07-30T19:35:31.867373230Z [info] üìù Directly assigned skills: object
2025-07-30T19:35:31.867373754Z [info]   totalXP: 25,
2025-07-30T19:35:31.867393341Z [info]   xpSpent: 2
2025-07-30T19:35:31.867405366Z [info] üìù Directly assigned powers: object
2025-07-30T19:35:31.867410780Z [info] }
2025-07-30T19:35:31.867426882Z [info] üìù Directly assigned merits: object
2025-07-30T19:35:31.867432663Z [info] üîç Processing advancementHistory: object Array with 1 items
2025-07-30T19:35:31.867446562Z [info] üìù Directly assigned lores: Array[0]
2025-07-30T19:35:31.867452192Z [info] ‚úÖ After processing advancementHistory: object Array with 1 items
2025-07-30T19:35:31.867466144Z [error]     at model.Query.exec (/app/node_modules/mongoose/lib/query.js:4604:80)
2025-07-30T19:35:31.867467527Z [info] üìù Directly assigned xpHistory: Array[1]
2025-07-30T19:35:31.867472032Z [info] üîç Processing xpHistory: object Array with 1 items
2025-07-30T19:35:31.867490700Z [info] ‚úÖ After processing xpHistory: object Array with 1 items
2025-07-30T19:35:31.867495498Z [info] üîç Before assignment - character.advancementHistory: Array[0] 
2025-07-30T19:35:31.867498420Z [error]     at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-07-30T19:35:31.867509598Z [info] üîç Processing lores: object Array with 0 items
2025-07-30T19:35:31.867516119Z [info] üîç Value to assign: Array[1]
2025-07-30T19:35:31.867523513Z [error]   stringValue: `"[\\n' +\n` +
2025-07-30T19:35:31.867529899Z [info] ‚úÖ After processing lores: object Array with 0 items
2025-07-30T19:35:31.867531910Z [info]     tribe: '',
2025-07-30T19:35:31.867544688Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:31.867550334Z [info] üßπ Repairing corrupted advancementHistory field in database
2025-07-30T19:35:31.867556568Z [info] üîç Processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:31.867557094Z [info]     guild: '',
2025-07-30T19:35:31.867564913Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:31.867574679Z [error] Character update error: CastError: Cast to [string] failed for value "[\n' +
2025-07-30T19:35:31.867578426Z [info] ‚úÖ After processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:31.867583810Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:31.867591609Z [error]   '  {\n' +
2025-07-30T19:35:31.867597075Z [info] üîç Processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:31.867603229Z [error]     `  "    itemId: 'archery',\\n" +\n` +
2025-07-30T19:35:31.867608115Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:31.867616644Z [info]     fellowship: null,
2025-07-30T19:35:31.867618992Z [info] ‚úÖ After processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:31.867624273Z [error]     "  '    level: 1,\\n' +\n" +
2025-07-30T19:35:31.867630857Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:31.867634227Z [info]     selectedClan: null,
2025-07-30T19:35:31.867639662Z [info] üîç Processing thornOptions: object Array with 0 items
2025-07-30T19:35:31.867644276Z [error]     "  '    cost: 2,\\n' +\n" +
2025-07-30T19:35:31.867651607Z [error]   "    itemId: 'archery',\n" +
2025-07-30T19:35:31.867652231Z [info]     created: '2025-07-30T19:35:28.234Z',
2025-07-30T19:35:31.867659717Z [info] ‚úÖ After processing thornOptions: object Array with 0 items
2025-07-30T19:35:31.867667439Z [error]     `  "    timestamp: '2025-07-30T19:35:32.123Z',\\n" +\n` +
2025-07-30T19:35:31.867670037Z [info]     lastModified: '2025-07-30T19:35:28.234Z',
2025-07-30T19:35:31.867673446Z [error]   '    level: 1,\n' +
2025-07-30T19:35:31.867678916Z [info] üîç Processing selectedPassions: object Array with 0 items
2025-07-30T19:35:31.867685146Z [info]     checkInCount: 0,
2025-07-30T19:35:31.867689587Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:31.867713279Z [error]   '    cost: 2,\n' +
2025-07-30T19:35:31.867722900Z [info]     stats: {
2025-07-30T19:35:31.867723141Z [info] ‚úÖ After processing selectedPassions: object Array with 0 items
2025-07-30T19:35:31.867725746Z [error]     "  '  }\\n' +\n" +
2025-07-30T19:35:31.867738165Z [error]   "    timestamp: '2025-07-30T19:35:32.123Z',\n" +
2025-07-30T19:35:31.867748951Z [error]     `  ']"`,
2025-07-30T19:35:31.867749335Z [info]       health: 10,
2025-07-30T19:35:31.867761644Z [error]   '    redundant: false\n' +
2025-07-30T19:35:31.867769671Z [error]   messageFormat: undefined,
2025-07-30T19:35:31.867776977Z [error]   '  }\n' +
2025-07-30T19:35:31.867788159Z [error]   kind: '[string]',
2025-07-30T19:35:31.867796953Z [error]   ']" (type string) at path "advancementHistory.0" because of "CastError"
2025-07-30T19:35:31.867808334Z [error]   value: '[\n' +
2025-07-30T19:35:31.867816502Z [error]     at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:414:15)
2025-07-30T19:35:31.867828554Z [error]     '  {\n' +
2025-07-30T19:35:31.867837430Z [error]     at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.867850457Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:31.867859472Z [error]     at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:31.867874651Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:31.867879509Z [error]     at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:31.867898048Z [error]     at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:31.867898642Z [error]     "    itemId: 'archery',\n" +
2025-07-30T19:35:31.867914770Z [error]     at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:31.867922449Z [error]     '    level: 1,\n' +
2025-07-30T19:35:31.867932667Z [error]     at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:31.867943252Z [error]     '    cost: 2,\n' +
2025-07-30T19:35:31.867952053Z [error]     at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23)
2025-07-30T19:35:31.867965396Z [error]     "    timestamp: '2025-07-30T19:35:32.123Z',\n" +
2025-07-30T19:35:31.867986044Z [error]     '    redundant: false\n' +
2025-07-30T19:35:31.868003560Z [error]     '  }\n' +
2025-07-30T19:35:31.868022775Z [error]     ']',
2025-07-30T19:35:31.868042383Z [error]   path: 'advancementHistory.0',
2025-07-30T19:35:31.868545812Z [error]   reason: CastError: Cast to string failed for value "{
2025-07-30T19:35:31.868569661Z [error]     checkIn: 0,
2025-07-30T19:35:31.868611246Z [error]     type: 'skill',
2025-07-30T19:35:31.868629917Z [error]     itemId: 'archery',
2025-07-30T19:35:31.868647269Z [error]     level: 1,
2025-07-30T19:35:31.868664166Z [error]     cost: 2,
2025-07-30T19:35:31.868681783Z [error]     timestamp: '2025-07-30T19:35:32.123Z',
2025-07-30T19:35:31.868699224Z [error]     redundant: false
2025-07-30T19:35:31.868720290Z [error]   }" (type Object) at path "advancementHistory"
2025-07-30T19:35:31.868739404Z [error]       at SchemaString.cast (/app/node_modules/mongoose/lib/schema/string.js:607:11)
2025-07-30T19:35:31.868759718Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.868779315Z [error]       at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:410:32)
2025-07-30T19:35:31.868797534Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.868816039Z [error]       at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:31.868834277Z [error]       at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:31.868851706Z [error]       at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:31.868868272Z [error]       at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:31.868887343Z [error]       at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:31.868903831Z [error]       at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23) {
2025-07-30T19:35:31.868918194Z [error]     stringValue: '"{\n' +
2025-07-30T19:35:31.868934329Z [error]       '  checkIn: 0,\n' +
2025-07-30T19:35:31.869050976Z [error]     at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:31.869078613Z [error]     at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:31.869101725Z [error]     at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:31.869155922Z [error]     at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:31.869178353Z [error]     at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23)
2025-07-30T19:35:31.869197205Z [error]     at model.Query.exec (/app/node_modules/mongoose/lib/query.js:4604:80)
2025-07-30T19:35:31.869218547Z [error]     at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-07-30T19:35:31.869238881Z [error]   stringValue: `"[\\n' +\n` +
2025-07-30T19:35:31.869260078Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:31.869279411Z [error]       "  type: 'skill',\n" +
2025-07-30T19:35:31.869281978Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:31.869302646Z [error]       "  itemId: 'archery',\n" +
2025-07-30T19:35:31.869303374Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:31.869324201Z [error]     `  "    itemId: 'archery',\\n" +\n` +
2025-07-30T19:35:31.869324341Z [error]       '  level: 1,\n' +
2025-07-30T19:35:31.869344995Z [error]       '  cost: 2,\n' +
2025-07-30T19:35:31.869346102Z [error]     "  '    level: 1,\\n' +\n" +
2025-07-30T19:35:31.869365739Z [error]       "  timestamp: '2025-07-30T19:35:32.123Z',\n" +
2025-07-30T19:35:31.869367833Z [error]     "  '    cost: 2,\\n' +\n" +
2025-07-30T19:35:31.869384032Z [error]       '  redundant: false\n' +
2025-07-30T19:35:31.869396817Z [error]     `  "    timestamp: '2025-07-30T19:35:31.925Z',\\n" +\n` +
2025-07-30T19:35:31.869403324Z [error]       '}"',
2025-07-30T19:35:31.869418946Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:31.869423869Z [error]     messageFormat: undefined,
2025-07-30T19:35:31.869436290Z [error]     "  '  },\\n' +\n" +
2025-07-30T19:35:31.869441472Z [error]     kind: 'string',
2025-07-30T19:35:31.869458260Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:31.869461571Z [error]     value: {
2025-07-30T19:35:31.869474864Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:31.869480302Z [error]       checkIn: 0,
2025-07-30T19:35:31.869494123Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:31.869501746Z [error]       type: 'skill',
2025-07-30T19:35:31.869512532Z [error]     `  "    itemId: 'archery',\\n" +\n` +
2025-07-30T19:35:31.869518927Z [error]       itemId: 'archery',
2025-07-30T19:35:31.869531233Z [error]     "  '    level: 2,\\n' +\n" +
2025-07-30T19:35:31.869536490Z [error]       level: 1,
2025-07-30T19:35:31.869553500Z [error]       cost: 2,
2025-07-30T19:35:31.869571827Z [error]       timestamp: '2025-07-30T19:35:32.123Z',
2025-07-30T19:35:31.869588979Z [error]       redundant: false
2025-07-30T19:35:31.869605243Z [error]     },
2025-07-30T19:35:31.869622173Z [error]     path: 'advancementHistory',
2025-07-30T19:35:31.869640235Z [error]     reason: null,
2025-07-30T19:35:31.869646805Z [error]     "  '    cost: 4,\\n' +\n" +
2025-07-30T19:35:31.869661115Z [error]     valueType: 'Object'
2025-07-30T19:35:31.869661579Z [error]       "  itemId: 'archery',\n" +
2025-07-30T19:35:31.869677698Z [error]     `  "    timestamp: '2025-07-30T19:35:32.315Z',\\n" +\n` +
2025-07-30T19:35:31.869679385Z [error]   },
2025-07-30T19:35:31.869686396Z [error]       '  level: 1,\n' +
2025-07-30T19:35:31.869698641Z [error]   valueType: 'string'
2025-07-30T19:35:31.869701915Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:31.869708627Z [error]       '  cost: 2,\n' +
2025-07-30T19:35:31.869716439Z [error] }
2025-07-30T19:35:31.869722977Z [error]     "  '  }\\n' +\n" +
2025-07-30T19:35:31.869730138Z [error]       "  timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.869739418Z [error]     `  ']"`,
2025-07-30T19:35:31.869753943Z [error]       '  redundant: false\n' +
2025-07-30T19:35:31.869756798Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:30 +0000] "PUT /api/characters/688a73fe54a32f443d2c4f3b HTTP/1.1" 500 61 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:31.869761482Z [error]   messageFormat: undefined,
2025-07-30T19:35:31.869774271Z [error]       '}"',
2025-07-30T19:35:31.869777760Z [info] Character update request: {
2025-07-30T19:35:31.869781710Z [error]   kind: '[string]',
2025-07-30T19:35:31.869798488Z [info]   characterId: '688a73fe54a32f443d2c4f3b',
2025-07-30T19:35:31.869798625Z [error]     messageFormat: undefined,
2025-07-30T19:35:31.869802007Z [error]   value: '[\n' +
2025-07-30T19:35:31.869820937Z [error]     '  {\n' +
2025-07-30T19:35:31.869824433Z [error]     kind: 'string',
2025-07-30T19:35:31.869843496Z [error]     value: {
2025-07-30T19:35:31.869843591Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:31.869862998Z [error]       checkIn: 0,
2025-07-30T19:35:31.869866590Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:31.869879928Z [error]       type: 'skill',
2025-07-30T19:35:31.869886392Z [error]     "    itemId: 'archery',\n" +
2025-07-30T19:35:31.869899586Z [error]       itemId: 'archery',
2025-07-30T19:35:31.869905472Z [error]     '    level: 1,\n' +
2025-07-30T19:35:31.869925892Z [error]       level: 1,
2025-07-30T19:35:31.869926669Z [error]     '    cost: 2,\n' +
2025-07-30T19:35:31.869945222Z [error]       cost: 2,
2025-07-30T19:35:31.869949171Z [error]     "    timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.869969089Z [error]       timestamp: '2025-07-30T19:35:31.925Z',
2025-07-30T19:35:31.869969806Z [error]     '    redundant: false\n' +
2025-07-30T19:35:31.869971233Z [info] üîç Value to assign: Array[3]
2025-07-30T19:35:31.869989328Z [error]       redundant: false
2025-07-30T19:35:31.869991893Z [error]     '  },\n' +
2025-07-30T19:35:31.869997010Z [info] üßπ Repairing corrupted advancementHistory field in database
2025-07-30T19:35:31.870010901Z [error]     },
2025-07-30T19:35:31.870013257Z [error]     '  {\n' +
2025-07-30T19:35:31.870018589Z [error] Character update error: CastError: Cast to [string] failed for value "[\n' +
2025-07-30T19:35:31.870034217Z [error]     path: 'advancementHistory',
2025-07-30T19:35:31.870035253Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:31.870036916Z [error]   '  {\n' +
2025-07-30T19:35:31.870054835Z [error]     reason: null,
2025-07-30T19:35:31.870056357Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:31.870059149Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:31.870074922Z [error]     valueType: 'Object'
2025-07-30T19:35:31.870092715Z [error]   },
2025-07-30T19:35:31.870095337Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:31.870112822Z [error]   valueType: 'string'
2025-07-30T19:35:31.870113089Z [error]   "    itemId: 'archery',\n" +
2025-07-30T19:35:31.870131341Z [error]   '    level: 1,\n' +
2025-07-30T19:35:31.870131695Z [error] }
2025-07-30T19:35:31.870147287Z [error]   '    cost: 2,\n' +
2025-07-30T19:35:31.870163718Z [error]   "    timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.870171969Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:30 +0000] "PUT /api/characters/688a73fe54a32f443d2c4f3b HTTP/1.1" 500 61 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:31.870190374Z [info] Character update request: {
2025-07-30T19:35:31.870207315Z [info]   characterId: '688a73fe54a32f443d2c4f3b',
2025-07-30T19:35:31.870225252Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:31.870241259Z [info]   bodyKeys: [
2025-07-30T19:35:31.870255488Z [error]   '    redundant: false\n' +
2025-07-30T19:35:31.870259667Z [info]     'userId',             'name',
2025-07-30T19:35:31.870271580Z [error]   '  },\n' +
2025-07-30T19:35:31.870278441Z [info]     'player',             'faction',
2025-07-30T19:35:31.870287373Z [error]   '  {\n' +
2025-07-30T19:35:31.870289849Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:31.870296936Z [info]     'subfaction',         'stats',
2025-07-30T19:35:31.870304031Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:31.870316259Z [info]     'skills',             'powers',
2025-07-30T19:35:31.870321201Z [info]   bodyKeys: [
2025-07-30T19:35:31.870323472Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:31.870336287Z [info]     'merits',             'lores',
2025-07-30T19:35:31.870340947Z [error]   "    itemId: 'archery',\n" +
2025-07-30T19:35:31.870342769Z [info]     'userId',             'name',
2025-07-30T19:35:31.870356633Z [info]     'totalXP',            'xpSpent',
2025-07-30T19:35:31.870360711Z [error]     "    itemId: 'archery',\n" +
2025-07-30T19:35:31.870363414Z [info]     'player',             'faction',
2025-07-30T19:35:31.870363642Z [error]   '    level: 2,\n' +
2025-07-30T19:35:31.870376852Z [info]     'checkInCount',       'xpHistory',
2025-07-30T19:35:31.870382055Z [error]   '    cost: 4,\n' +
2025-07-30T19:35:31.870384198Z [info]     'subfaction',         'stats',
2025-07-30T19:35:31.870397495Z [error]   "    timestamp: '2025-07-30T19:35:32.315Z',\n" +
2025-07-30T19:35:31.870400760Z [error]     '    level: 2,\n' +
2025-07-30T19:35:31.870401606Z [info]     'advancementHistory', 'innateTreeIds',
2025-07-30T19:35:31.870404171Z [info]     'skills',             'powers',
2025-07-30T19:35:31.870411025Z [error]   '    redundant: false\n' +
2025-07-30T19:35:31.870420494Z [error]     '    cost: 4,\n' +
2025-07-30T19:35:31.870424764Z [error]   '  },\n' +
2025-07-30T19:35:31.870425389Z [info]     'merits',             'lores',
2025-07-30T19:35:31.870427937Z [info]     'fundamentalPowers',  'shadowArchetype',
2025-07-30T19:35:31.870441126Z [error]   '  {\n' +
2025-07-30T19:35:31.870446137Z [error]     "    timestamp: '2025-07-30T19:35:32.315Z',\n" +
2025-07-30T19:35:31.870447402Z [info]     'totalXP',            'xpSpent',
2025-07-30T19:35:31.870447730Z [info]     'thornOptions',       'selectedPassions',
2025-07-30T19:35:31.870455367Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:31.870466566Z [error]     '    redundant: false\n' +
2025-07-30T19:35:31.870468190Z [info]     'generation',         'amaranthCount',
2025-07-30T19:35:31.870468709Z [info]     'checkInCount',       'xpHistory',
2025-07-30T19:35:31.870469306Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:31.870487116Z [error]   "    itemId: 'archery',\n" +
2025-07-30T19:35:31.870488633Z [info]     'breed',              'auspice',
2025-07-30T19:35:31.870489396Z [error]     '  }\n' +
2025-07-30T19:35:31.870491436Z [info]     'advancementHistory', 'innateTreeIds',
2025-07-30T19:35:31.870501386Z [error]   '    level: 3,\n' +
2025-07-30T19:35:31.870510218Z [info]     'guild',              'claimedStatus',
2025-07-30T19:35:31.870511238Z [error]     ']',
2025-07-30T19:35:31.870513349Z [info]     'fundamentalPowers',  'shadowArchetype',
2025-07-30T19:35:31.870518557Z [error]   '    cost: 6,\n' +
2025-07-30T19:35:31.870530713Z [info]     'selectedFomoriTree', 'claimedInnateTreeIds',
2025-07-30T19:35:31.870534840Z [info]     'thornOptions',       'selectedPassions',
2025-07-30T19:35:31.870534982Z [error]   "    timestamp: '2025-07-30T19:35:32.936Z',\n" +
2025-07-30T19:35:31.870535857Z [error]   path: 'advancementHistory.0',
2025-07-30T19:35:31.870552326Z [info]     'selfNerfs',          'notes',
2025-07-30T19:35:31.870552392Z [error]   '    redundant: false\n' +
2025-07-30T19:35:31.870555327Z [info]     'generation',         'amaranthCount',
2025-07-30T19:35:31.870562366Z [error]   reason: CastError: Cast to string failed for value "{
2025-07-30T19:35:31.870570908Z [error]   '  }\n' +
2025-07-30T19:35:31.870572362Z [info]     'isPublic',           'campaignId',
2025-07-30T19:35:31.870575581Z [info]     'breed',              'auspice',
2025-07-30T19:35:31.870580968Z [error]     checkIn: 0,
2025-07-30T19:35:31.870594521Z [info]     'version',            'lastModified',
2025-07-30T19:35:31.870594829Z [error]   ']" (type string) at path "advancementHistory.0" because of "CastError"
2025-07-30T19:35:31.870596435Z [info]     'guild',              'claimedStatus',
2025-07-30T19:35:31.870616085Z [info]     '_id',                'sharedWith',
2025-07-30T19:35:31.870616406Z [info]     'selectedFomoriTree', 'claimedInnateTreeIds',
2025-07-30T19:35:31.870622901Z [error]     type: 'skill',
2025-07-30T19:35:31.870622951Z [error]     at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:414:15)
2025-07-30T19:35:31.870636784Z [info]     'factionChanges',     'createdAt',
2025-07-30T19:35:31.870636991Z [info]     'selfNerfs',          'notes',
2025-07-30T19:35:31.870644626Z [error]     itemId: 'archery',
2025-07-30T19:35:31.870647199Z [error]     at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.870656258Z [info]     'updatedAt',          '__v',
2025-07-30T19:35:31.870658721Z [info]     'isPublic',           'campaignId',
2025-07-30T19:35:31.870665024Z [error]     level: 1,
2025-07-30T19:35:31.870673657Z [error]     at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:31.870674881Z [info]     'id'
2025-07-30T19:35:31.870677284Z [info]     'version',            'lastModified',
2025-07-30T19:35:31.870685122Z [error]     cost: 2,
2025-07-30T19:35:31.870696487Z [info]   ],
2025-07-30T19:35:31.870699015Z [error]     at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:31.870699058Z [info]     '_id',                'sharedWith',
2025-07-30T19:35:31.870703692Z [error]     `  "    timestamp: '2025-07-30T19:35:31.925Z',\\n" +\n` +
2025-07-30T19:35:31.870708685Z [error]     timestamp: '2025-07-30T19:35:31.925Z',
2025-07-30T19:35:31.870715505Z [info]   hasStats: true,
2025-07-30T19:35:31.870719629Z [error]     at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:31.870725169Z [error]     redundant: false
2025-07-30T19:35:31.870735103Z [info]   hasSkills: true,
2025-07-30T19:35:31.870741087Z [error]     at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:31.870746801Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:31.870747239Z [error]   }" (type Object) at path "advancementHistory"
2025-07-30T19:35:31.870755826Z [info]   hasPowers: true,
2025-07-30T19:35:31.870767474Z [error]     at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:31.870775377Z [error]     "  '  },\\n' +\n" +
2025-07-30T19:35:31.870775617Z [error]       at SchemaString.cast (/app/node_modules/mongoose/lib/schema/string.js:607:11)
2025-07-30T19:35:31.870777085Z [info]   hasMerits: true,
2025-07-30T19:35:31.870796683Z [error]     at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23)
2025-07-30T19:35:31.870803181Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:31.870803630Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.870807019Z [info]     'factionChanges',     'createdAt',
2025-07-30T19:35:31.870822255Z [error]     at model.Query.exec (/app/node_modules/mongoose/lib/query.js:4604:80)
2025-07-30T19:35:31.870828201Z [error]       at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:410:32)
2025-07-30T19:35:31.870833107Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:31.870842086Z [info]     'updatedAt',          '__v',
2025-07-30T19:35:31.870855641Z [error]     at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-07-30T19:35:31.870856345Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.870866235Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:31.870866911Z [info]     'id'
2025-07-30T19:35:31.870881786Z [error]   stringValue: `"[\\n' +\n` +
2025-07-30T19:35:31.870882195Z [error]       at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:31.870891520Z [info]   ],
2025-07-30T19:35:31.870893549Z [error]     `  "    itemId: 'archery',\\n" +\n` +
2025-07-30T19:35:31.870905588Z [error]       at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:31.870913218Z [info]   hasStats: true,
2025-07-30T19:35:31.870918005Z [error]     "  '    level: 2,\\n' +\n" +
2025-07-30T19:35:31.870918272Z [info]       maxHealth: 10,
2025-07-30T19:35:31.870928418Z [error]       at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:31.870929849Z [info]   hasSkills: true,
2025-07-30T19:35:31.870937836Z [error]     "  '    cost: 4,\\n' +\n" +
2025-07-30T19:35:31.870948408Z [info]   hasPowers: true,
2025-07-30T19:35:31.870952197Z [error]       at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:31.870954409Z [info]       willpower: 1,
2025-07-30T19:35:31.870963676Z [info]   hasMerits: true,
2025-07-30T19:35:31.870979270Z [error]     `  "    timestamp: '2025-07-30T19:35:32.315Z',\\n" +\n` +
2025-07-30T19:35:31.870979701Z [error]       at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:31.870980082Z [info]   hasLores: true,
2025-07-30T19:35:31.870982947Z [info]       energy: 10,
2025-07-30T19:35:31.870996073Z [info]   hasAdvancementHistory: true,
2025-07-30T19:35:31.871007690Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:31.871008122Z [info]       maxEnergy: 10,
2025-07-30T19:35:31.871008197Z [error]       at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23) {
2025-07-30T19:35:31.871014148Z [info]   advancementHistoryType: 'object',
2025-07-30T19:35:31.871034078Z [error]     stringValue: '"{\n' +
2025-07-30T19:35:31.871035122Z [error]     "  '  },\\n' +\n" +
2025-07-30T19:35:31.871035381Z [info]       virtue: 7,
2025-07-30T19:35:31.871039993Z [info]   advancementHistoryValue: '[{checkIn:0,type:"skill",itemId:"archery",level:1,cost:2,timestamp:"2025-07-30T19:35:31.925Z",redundant:false},{checkIn:0,type:"skill",itemId:"archery",level:2,cost:4,"timestam...',
2025-07-30T19:35:31.871053812Z [info]   totalXP: 21,
2025-07-30T19:35:31.871058548Z [error]       '  checkIn: 0,\n' +
2025-07-30T19:35:31.871063374Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:31.871064198Z [info]       virtueType: 'Humanity',
2025-07-30T19:35:31.871070374Z [info]   xpSpent: 6
2025-07-30T19:35:31.871078310Z [error]       "  type: 'skill',\n" +
2025-07-30T19:35:31.871089510Z [info] }
2025-07-30T19:35:31.871091389Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:31.871091702Z [info]       energyType: 'Vitality'
2025-07-30T19:35:31.871092597Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:31.871095797Z [info]   hasLores: true,
2025-07-30T19:35:31.871116704Z [info] üîç Processing advancementHistory: object Array with 2 items
2025-07-30T19:35:31.871117410Z [info]     },
2025-07-30T19:35:31.871119336Z [info]   hasAdvancementHistory: true,
2025-07-30T19:35:31.871122589Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:31.871128134Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:31.871134349Z [info] ‚úÖ After processing advancementHistory: object Array with 2 items
2025-07-30T19:35:31.871141259Z [info]   advancementHistoryType: 'object',
2025-07-30T19:35:31.871143817Z [info]     skills: { academics: 3 },
2025-07-30T19:35:31.871150183Z [error]     `  "    itemId: 'archery',\\n" +\n` +
2025-07-30T19:35:31.871153932Z [info] üîç Processing xpHistory: object Array with 2 items
2025-07-30T19:35:31.871155183Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:31.871161267Z [info]     powers: { brash: [Object] },
2025-07-30T19:35:31.871168876Z [info]   advancementHistoryValue: '[{checkIn:0,type:"skill",itemId:"archery",level:1,cost:2,timestamp:"2025-07-30T19:35:31.925Z",redundant:false},{checkIn:0,type:"skill",itemId:"archery",level:2,cost:4,"timestam...',
2025-07-30T19:35:31.871175693Z [info] ‚úÖ After processing xpHistory: object Array with 2 items
2025-07-30T19:35:31.871176845Z [info]     merits: { adept: true },
2025-07-30T19:35:31.871178576Z [error]     "  '    level: 3,\\n' +\n" +
2025-07-30T19:35:31.871179483Z [error]     `  "    itemId: 'archery',\\n" +\n` +
2025-07-30T19:35:31.871190362Z [info]   totalXP: 15,
2025-07-30T19:35:31.871192263Z [info] üîç Processing lores: object Array with 0 items
2025-07-30T19:35:31.871206248Z [error]     "  '    cost: 6,\\n' +\n" +
2025-07-30T19:35:31.871206857Z [error]     "  '    level: 1,\\n' +\n" +
2025-07-30T19:35:31.871209562Z [info] ‚úÖ After processing lores: object Array with 0 items
2025-07-30T19:35:31.871211745Z [info]   xpSpent: 12
2025-07-30T19:35:31.871228453Z [info] üîç Processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:31.871231753Z [error]     "  '    cost: 2,\\n' +\n" +
2025-07-30T19:35:31.871236141Z [info] }
2025-07-30T19:35:31.871237114Z [error]     `  "    timestamp: '2025-07-30T19:35:32.936Z',\\n" +\n` +
2025-07-30T19:35:31.871259184Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:31.871266537Z [info] üîç Processing advancementHistory: object Array with 3 items
2025-07-30T19:35:31.871281188Z [info] ‚úÖ After processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:31.871283448Z [error]     "  '  }\\n' +\n" +
2025-07-30T19:35:31.871289412Z [info] ‚úÖ After processing advancementHistory: object Array with 3 items
2025-07-30T19:35:31.871304194Z [error]     `  ']"`,
2025-07-30T19:35:31.871310208Z [info] üîç Processing xpHistory: object Array with 3 items
2025-07-30T19:35:31.871326036Z [error]   messageFormat: undefined,
2025-07-30T19:35:31.871347351Z [error]   kind: '[string]',
2025-07-30T19:35:31.871352738Z [info] üîç Processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:31.871363301Z [info] ‚úÖ After processing xpHistory: object Array with 3 items
2025-07-30T19:35:31.871371159Z [error]   value: '[\n' +
2025-07-30T19:35:31.871373855Z [info] ‚úÖ After processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:31.871384727Z [info] üîç Processing lores: object Array with 0 items
2025-07-30T19:35:31.871395414Z [error]     '  {\n' +
2025-07-30T19:35:31.871395479Z [info] üîç Processing thornOptions: object Array with 0 items
2025-07-30T19:35:31.871406495Z [info] ‚úÖ After processing lores: object Array with 0 items
2025-07-30T19:35:31.871419500Z [info] ‚úÖ After processing thornOptions: object Array with 0 items
2025-07-30T19:35:31.871422636Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:31.871428417Z [info] üîç Processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:31.871436152Z [info] üîç Processing selectedPassions: object Array with 0 items
2025-07-30T19:35:31.871445763Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:31.871452470Z [info] ‚úÖ After processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:31.871472198Z [info] ‚úÖ After processing selectedPassions: object Array with 0 items
2025-07-30T19:35:31.871475757Z [info] üîç Processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:31.871477211Z [error]     "    itemId: 'archery',\n" +
2025-07-30T19:35:31.871487896Z [info] üîç Processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:31.871497407Z [info] ‚úÖ After processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:31.871501649Z [error]     '    level: 1,\n' +
2025-07-30T19:35:31.871507406Z [info] ‚úÖ After processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:31.871520147Z [info] üîç Processing thornOptions: object Array with 0 items
2025-07-30T19:35:31.871527261Z [info] üîç Processing selfNerfs: object Array with 0 items
2025-07-30T19:35:31.871527968Z [error]     '    cost: 2,\n' +
2025-07-30T19:35:31.871539502Z [info] ‚úÖ After processing thornOptions: object Array with 0 items
2025-07-30T19:35:31.871543276Z [info] ‚úÖ After processing selfNerfs: object Array with 0 items
2025-07-30T19:35:31.871550715Z [error]     "    timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.871560003Z [info] üîç Processing sharedWith: object Array with 0 items
2025-07-30T19:35:31.871561289Z [info] üîç Processing selectedPassions: object Array with 0 items
2025-07-30T19:35:31.871569761Z [error]     '    redundant: false\n' +
2025-07-30T19:35:31.871575199Z [info] ‚úÖ After processing sharedWith: object Array with 0 items
2025-07-30T19:35:31.871583237Z [info] ‚úÖ After processing selectedPassions: object Array with 0 items
2025-07-30T19:35:31.871595534Z [error]     '  },\n' +
2025-07-30T19:35:31.871596359Z [info] üîç Processing factionChanges: object Array with 0 items
2025-07-30T19:35:31.871604777Z [info] üîç Processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:31.871612876Z [info] ‚úÖ After processing factionChanges: object Array with 0 items
2025-07-30T19:35:31.871618761Z [error]     '  {\n' +
2025-07-30T19:35:31.871627411Z [info] ‚úÖ After processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:31.871629461Z [info] üîç Processing object stats: object
2025-07-30T19:35:31.871636331Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:31.871648263Z [info] üîç Processing selfNerfs: object Array with 0 items
2025-07-30T19:35:31.871656997Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:31.871669018Z [info] ‚úÖ After processing selfNerfs: object Array with 0 items
2025-07-30T19:35:31.871675550Z [error]     "    itemId: 'archery',\n" +
2025-07-30T19:35:31.871681377Z [info] ‚úÖ After processing object stats: object
2025-07-30T19:35:31.871706740Z [info] üîç Processing sharedWith: object Array with 0 items
2025-07-30T19:35:31.871715550Z [info] üîç Processing object skills: object
2025-07-30T19:35:31.871728047Z [info] ‚úÖ After processing sharedWith: object Array with 0 items
2025-07-30T19:35:31.871737159Z [info] ‚úÖ After processing object skills: object
2025-07-30T19:35:31.871748252Z [info] üîç Processing factionChanges: object Array with 0 items
2025-07-30T19:35:31.871755153Z [info] üîç Processing object powers: object
2025-07-30T19:35:31.871769276Z [info] ‚úÖ After processing factionChanges: object Array with 0 items
2025-07-30T19:35:31.871777108Z [info] ‚úÖ After processing object powers: object
2025-07-30T19:35:31.871782292Z [error]     '    level: 2,\n' +
2025-07-30T19:35:31.871787105Z [info]     lores: [],
2025-07-30T19:35:31.871793074Z [info] üîç Processing object stats: object
2025-07-30T19:35:31.871797800Z [info] üîç Processing object merits: object
2025-07-30T19:35:31.871808543Z [error]     '    cost: 4,\n' +
2025-07-30T19:35:31.871809280Z [info]     notes: '',
2025-07-30T19:35:31.871815694Z [info] ‚úÖ After processing object stats: object
2025-07-30T19:35:31.871820793Z [info] ‚úÖ After processing object merits: object
2025-07-30T19:35:31.871833606Z [error]     "    timestamp: '2025-07-30T19:35:32.315Z',\n" +
2025-07-30T19:35:31.871837420Z [info]     advancementHistory: [],
2025-07-30T19:35:31.871840986Z [info] üìù Directly assigned stats: object
2025-07-30T19:35:31.871843798Z [info] üîç Processing object skills: object
2025-07-30T19:35:31.871858628Z [info]     xpHistory: [],
2025-07-30T19:35:31.871860322Z [error]     '    redundant: false\n' +
2025-07-30T19:35:31.871862098Z [info] üìù Directly assigned skills: object
2025-07-30T19:35:31.871867486Z [info] ‚úÖ After processing object skills: object
2025-07-30T19:35:31.871879217Z [info]     totalXP: 27,
2025-07-30T19:35:31.871884581Z [error]     '  },\n' +
2025-07-30T19:35:31.871895662Z [info] üîç Processing object powers: object
2025-07-30T19:35:31.871896571Z [info] üìù Directly assigned powers: object
2025-07-30T19:35:31.871911827Z [info]     xpSpent: 0,
2025-07-30T19:35:31.871913563Z [error]     '  {\n' +
2025-07-30T19:35:31.871918619Z [info] ‚úÖ After processing object powers: object
2025-07-30T19:35:31.871918681Z [info] üìù Directly assigned merits: object
2025-07-30T19:35:31.871930298Z [info]     freebieXP: 27,
2025-07-30T19:35:31.871940532Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:31.871945662Z [info] üîç Processing object merits: object
2025-07-30T19:35:31.871946683Z [info] üìù Directly assigned lores: Array[0]
2025-07-30T19:35:31.871949863Z [info]     generation: 10,
2025-07-30T19:35:31.871960611Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:31.871969260Z [info] üìù Directly assigned xpHistory: Array[2]
2025-07-30T19:35:31.871972370Z [info] ‚úÖ After processing object merits: object
2025-07-30T19:35:31.871972920Z [info]     amaranthCount: 0,
2025-07-30T19:35:31.871979987Z [error]     "    itemId: 'archery',\n" +
2025-07-30T19:35:31.871993004Z [info] üîç Before assignment - character.advancementHistory: Array[0] 
2025-07-30T19:35:31.871995214Z [info] üìù Directly assigned stats: object
2025-07-30T19:35:31.871995287Z [info]     innateTreeIds: [ 'brash' ],
2025-07-30T19:35:31.872002228Z [error]     '    level: 3,\n' +
2025-07-30T19:35:31.872015366Z [info] üîç Value to assign: Array[2]
2025-07-30T19:35:31.872017552Z [info] üìù Directly assigned skills: object
2025-07-30T19:35:31.872017890Z [info]     fundamentalPowers: [],
2025-07-30T19:35:31.872038005Z [info]     shadowArchetype: '',
2025-07-30T19:35:31.872038818Z [info] üìù Directly assigned powers: object
2025-07-30T19:35:31.872039569Z [info] üßπ Repairing corrupted advancementHistory field in database
2025-07-30T19:35:31.872062593Z [error]     '    cost: 6,\n' +
2025-07-30T19:35:31.872062621Z [info]     thornOptions: [],
2025-07-30T19:35:31.872064250Z [info] üìù Directly assigned merits: object
2025-07-30T19:35:31.872067916Z [error] Character update error: CastError: Cast to [string] failed for value "[\n' +
2025-07-30T19:35:31.872085914Z [info]     selectedThorn: '',
2025-07-30T19:35:31.872089506Z [error]     "    timestamp: '2025-07-30T19:35:32.936Z',\n" +
2025-07-30T19:35:31.872089963Z [error]   '  {\n' +
2025-07-30T19:35:31.872093289Z [info] üìù Directly assigned lores: Array[0]
2025-07-30T19:35:31.872104354Z [info]     selectedPassions: [],
2025-07-30T19:35:31.872114839Z [error]     '    redundant: false\n' +
2025-07-30T19:35:31.872115264Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:31.872116752Z [info] üìù Directly assigned xpHistory: Array[3]
2025-07-30T19:35:31.872123604Z [info]     mixedSubfaction: null,
2025-07-30T19:35:31.872138693Z [error]     '  }\n' +
2025-07-30T19:35:31.872141888Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:31.872143751Z [info] üîç Before assignment - character.advancementHistory: Array[0] 
2025-07-30T19:35:31.872144497Z [info]     claimedStatus: null,
2025-07-30T19:35:31.872162507Z [error]     ']',
2025-07-30T19:35:31.872164497Z [info]     selectedFomoriTree: null,
2025-07-30T19:35:31.872166354Z [error]   "    itemId: 'archery',\n" +
2025-07-30T19:35:31.872185723Z [info]     claimedInnateTreeIds: [],
2025-07-30T19:35:31.872192024Z [error]   '    level: 1,\n' +
2025-07-30T19:35:31.872193979Z [error]   path: 'advancementHistory.0',
2025-07-30T19:35:31.872206237Z [info]     firstMeritFree: true,
2025-07-30T19:35:31.872213738Z [error]   '    cost: 2,\n' +
2025-07-30T19:35:31.872221866Z [error]   reason: CastError: Cast to string failed for value "{
2025-07-30T19:35:31.872227692Z [info]     validationErrors: [],
2025-07-30T19:35:31.872234035Z [error]   "    timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.872242517Z [error]     checkIn: 0,
2025-07-30T19:35:31.872254509Z [error]   '    redundant: false\n' +
2025-07-30T19:35:31.872259290Z [info]     buildPlans: [],
2025-07-30T19:35:31.872273521Z [error]   '  },\n' +
2025-07-30T19:35:31.872279262Z [info]     teachingsReceived: [],
2025-07-30T19:35:31.872292283Z [error]   '  {\n' +
2025-07-30T19:35:31.872296220Z [info]     teachingsGiven: [],
2025-07-30T19:35:31.872311599Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:31.872314299Z [info]     selfNerfs: [],
2025-07-30T19:35:31.872331108Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:31.872332522Z [info]     tempFactionChangePowers: 0,
2025-07-30T19:35:31.872350861Z [error]   "    itemId: 'archery',\n" +
2025-07-30T19:35:31.872367513Z [error]   '    level: 2,\n' +
2025-07-30T19:35:31.872383282Z [error]   '    cost: 4,\n' +
2025-07-30T19:35:31.872421344Z [info]     freeFirstDotPowers: []
2025-07-30T19:35:31.872438951Z [info]   }
2025-07-30T19:35:31.872452627Z [info] }
2025-07-30T19:35:31.872469428Z [info] Creating character with processed data: {
2025-07-30T19:35:31.872489586Z [error]   "    timestamp: '2025-07-30T19:35:32.315Z',\n" +
2025-07-30T19:35:31.872490109Z [info]   id: 1753904128234.3064,
2025-07-30T19:35:31.872509679Z [error]   '    redundant: false\n' +
2025-07-30T19:35:31.872529391Z [error]   '  }\n' +
2025-07-30T19:35:31.872550098Z [error]   ']" (type string) at path "advancementHistory.0" because of "CastError"
2025-07-30T19:35:31.872603851Z [error]     at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:414:15)
2025-07-30T19:35:31.872625218Z [error]     at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.872648593Z [error]     at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:31.872863553Z [info]   name: 'test 1',
2025-07-30T19:35:31.872873486Z [info]   player: 't',
2025-07-30T19:35:31.872884191Z [info]   faction: 'human',
2025-07-30T19:35:31.872894728Z [info]   subfaction: 'commoner',
2025-07-30T19:35:31.872904852Z [info]   clan: '',
2025-07-30T19:35:31.872915712Z [info]   breed: '',
2025-07-30T19:35:31.872928068Z [info]   auspice: '',
2025-07-30T19:35:31.872939727Z [info]   tribe: '',
2025-07-30T19:35:31.872949492Z [info]   guild: '',
2025-07-30T19:35:31.872960479Z [info]   fellowship: null,
2025-07-30T19:35:31.872971671Z [info]   selectedClan: null,
2025-07-30T19:35:31.872983276Z [info]   created: '2025-07-30T19:35:28.234Z',
2025-07-30T19:35:31.872994444Z [info]   lastModified: '2025-07-30T19:35:28.234Z',
2025-07-30T19:35:31.873004980Z [info]   checkInCount: 0,
2025-07-30T19:35:31.873014697Z [info]   stats: {
2025-07-30T19:35:31.873025503Z [info]     health: 10,
2025-07-30T19:35:31.873036714Z [info]     maxHealth: 10,
2025-07-30T19:35:31.873048645Z [info]     willpower: 1,
2025-07-30T19:35:31.873060137Z [info]     energy: 10,
2025-07-30T19:35:31.873070642Z [info]     maxEnergy: 10,
2025-07-30T19:35:31.873081708Z [info]     virtue: 7,
2025-07-30T19:35:31.873112622Z [info]     virtueType: 'Humanity',
2025-07-30T19:35:31.873144709Z [info]     energyType: 'Vitality'
2025-07-30T19:35:31.873159065Z [info]   },
2025-07-30T19:35:31.873174500Z [info]   skills: { academics: 3 },
2025-07-30T19:35:31.873191006Z [info]   powers: { brash: { '1': true } },
2025-07-30T19:35:31.873207985Z [info]   merits: { adept: true },
2025-07-30T19:35:31.873225018Z [info]   lores: [],
2025-07-30T19:35:31.873238326Z [info]   notes: '',
2025-07-30T19:35:31.873250392Z [info]   advancementHistory: [],
2025-07-30T19:35:31.873263355Z [info]   xpHistory: [],
2025-07-30T19:35:31.873274671Z [info]   totalXP: 27,
2025-07-30T19:35:31.873285413Z [info]   xpSpent: 0,
2025-07-30T19:35:31.873303486Z [error]       '  level: 1,\n' +
2025-07-30T19:35:31.873329709Z [error]       '  cost: 2,\n' +
2025-07-30T19:35:31.873352647Z [error]       "  timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.873372906Z [error]       '  redundant: false\n' +
2025-07-30T19:35:31.873403826Z [error]       '}"',
2025-07-30T19:35:31.873426109Z [error]     messageFormat: undefined,
2025-07-30T19:35:31.873443189Z [error]     kind: 'string',
2025-07-30T19:35:31.873460980Z [error]     value: {
2025-07-30T19:35:31.873478142Z [error]       checkIn: 0,
2025-07-30T19:35:31.873497021Z [error]       type: 'skill',
2025-07-30T19:35:31.873514400Z [error]       itemId: 'archery',
2025-07-30T19:35:31.873531137Z [error]       level: 1,
2025-07-30T19:35:31.873547916Z [error]       cost: 2,
2025-07-30T19:35:31.873565831Z [error]       timestamp: '2025-07-30T19:35:31.925Z',
2025-07-30T19:35:31.873583182Z [error]       redundant: false
2025-07-30T19:35:31.873600063Z [error]     },
2025-07-30T19:35:31.873617975Z [error]     path: 'advancementHistory',
2025-07-30T19:35:31.873635848Z [error]     reason: null,
2025-07-30T19:35:31.873653497Z [error]     valueType: 'Object'
2025-07-30T19:35:31.873669857Z [error]   },
2025-07-30T19:35:31.873690008Z [error]   valueType: 'string'
2025-07-30T19:35:31.873695063Z [info]   freebieXP: 27,
2025-07-30T19:35:31.873709141Z [error] }
2025-07-30T19:35:31.873714707Z [info]   generation: 10,
2025-07-30T19:35:31.873731504Z [info]   amaranthCount: 0,
2025-07-30T19:35:31.873754453Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:31 +0000] "PUT /api/characters/688a73fe54a32f443d2c4f3b HTTP/1.1" 500 61 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:31.873755046Z [info]   innateTreeIds: [ 'brash' ],
2025-07-30T19:35:31.873773265Z [info]   fundamentalPowers: [],
2025-07-30T19:35:31.873790623Z [info]   shadowArchetype: '',
2025-07-30T19:35:31.873805363Z [info]   thornOptions: [],
2025-07-30T19:35:31.873819659Z [info]   selectedThorn: '',
2025-07-30T19:35:31.873836186Z [info]   selectedPassions: [],
2025-07-30T19:35:31.873852054Z [info]   mixedSubfaction: null,
2025-07-30T19:35:31.873867043Z [info]   claimedStatus: null,
2025-07-30T19:35:31.873882993Z [info]   selectedFomoriTree: null,
2025-07-30T19:35:31.873897734Z [info]   claimedInnateTreeIds: [],
2025-07-30T19:35:31.873912327Z [info]   firstMeritFree: true,
2025-07-30T19:35:31.873927765Z [info]   validationErrors: [],
2025-07-30T19:35:31.873941494Z [info]   buildPlans: [],
2025-07-30T19:35:31.873961129Z [info]   teachingsReceived: [],
2025-07-30T19:35:31.873977289Z [info]   teachingsGiven: [],
2025-07-30T19:35:31.873993183Z [info]   selfNerfs: [],
2025-07-30T19:35:31.874008163Z [info]   tempFactionChangePowers: 0,
2025-07-30T19:35:31.874024454Z [info]   freeFirstDotPowers: [],
2025-07-30T19:35:31.874040788Z [info]   userId: '6889a102acb70dc0dcb3b834'
2025-07-30T19:35:31.874057547Z [info] }
2025-07-30T19:35:31.874074340Z [info] Character created successfully: new ObjectId('688a73fe54a32f443d2c4f3b')
2025-07-30T19:35:31.874100678Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:26 +0000] "POST /api/characters HTTP/1.1" 201 1016 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:31.874120202Z [info] Character update request: {
2025-07-30T19:35:31.874139011Z [info]   characterId: '688a73fe54a32f443d2c4f3b',
2025-07-30T19:35:31.874617783Z [info]   userId: '6889a102acb70dc0dcb3b834',
2025-07-30T19:35:31.874631021Z [info]   bodyKeys: [
2025-07-30T19:35:31.874647209Z [info]     'userId',             'name',
2025-07-30T19:35:31.874663117Z [info]     'player',             'faction',
2025-07-30T19:35:31.874676385Z [info]     'subfaction',         'stats',
2025-07-30T19:35:31.874691950Z [info]     'skills',             'powers',
2025-07-30T19:35:31.874706729Z [info]     'merits',             'lores',
2025-07-30T19:35:31.874720819Z [info]     'totalXP',            'xpSpent',
2025-07-30T19:35:31.874735915Z [info]     'checkInCount',       'xpHistory',
2025-07-30T19:35:31.874750754Z [info]     'advancementHistory', 'innateTreeIds',
2025-07-30T19:35:31.874765608Z [info]     'fundamentalPowers',  'shadowArchetype',
2025-07-30T19:35:31.874780452Z [info]     'thornOptions',       'selectedPassions',
2025-07-30T19:35:31.874795210Z [info]     'generation',         'amaranthCount',
2025-07-30T19:35:31.874809379Z [info]     'breed',              'auspice',
2025-07-30T19:35:31.874826118Z [info]     'guild',              'claimedStatus',
2025-07-30T19:35:31.874841087Z [info]     'selectedFomoriTree', 'claimedInnateTreeIds',
2025-07-30T19:35:31.874859609Z [info]     'selfNerfs',          'notes',
2025-07-30T19:35:31.874872891Z [info]     'isPublic',           'campaignId',
2025-07-30T19:35:31.874887477Z [info]     'version',            'lastModified',
2025-07-30T19:35:31.874901884Z [info]     '_id',                'sharedWith',
2025-07-30T19:35:31.874917408Z [info]     'factionChanges',     'createdAt',
2025-07-30T19:35:31.874931573Z [info]     'updatedAt',          '__v',
2025-07-30T19:35:31.874944180Z [info]     'id'
2025-07-30T19:35:31.874956998Z [info]   ],
2025-07-30T19:35:31.874970826Z [info]   hasStats: true,
2025-07-30T19:35:31.874983725Z [info]   hasSkills: true,
2025-07-30T19:35:31.874997562Z [info]   hasPowers: true,
2025-07-30T19:35:31.875459441Z [info]   hasMerits: true,
2025-07-30T19:35:31.875474526Z [info]   hasLores: true,
2025-07-30T19:35:31.875491222Z [info]   hasAdvancementHistory: true,
2025-07-30T19:35:31.875505087Z [info]   advancementHistoryType: 'object',
2025-07-30T19:35:31.875533462Z [info]   advancementHistoryValue: '[{checkIn:0,type:"skill",itemId:"archery",level:1,cost:2,timestamp:"2025-07-30T19:35:31.925Z",redundant:false}]...',
2025-07-30T19:35:31.875549615Z [info]   totalXP: 25,
2025-07-30T19:35:31.875564550Z [info]   xpSpent: 2
2025-07-30T19:35:31.875579279Z [info] }
2025-07-30T19:35:31.875603832Z [info] üîç Processing advancementHistory: object Array with 1 items
2025-07-30T19:35:31.875623069Z [info] ‚úÖ After processing advancementHistory: object Array with 1 items
2025-07-30T19:35:31.875640505Z [info] üîç Processing xpHistory: object Array with 1 items
2025-07-30T19:35:31.875657874Z [info] ‚úÖ After processing xpHistory: object Array with 1 items
2025-07-30T19:35:31.875675921Z [info] üîç Processing lores: object Array with 0 items
2025-07-30T19:35:31.876311942Z [info] ‚úÖ After processing lores: object Array with 0 items
2025-07-30T19:35:31.876363655Z [info] üîç Processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:31.876382068Z [info] ‚úÖ After processing innateTreeIds: object Array with 1 items
2025-07-30T19:35:31.876400128Z [info] üîç Processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:31.876419312Z [info] ‚úÖ After processing fundamentalPowers: object Array with 0 items
2025-07-30T19:35:31.876436758Z [info] üîç Processing thornOptions: object Array with 0 items
2025-07-30T19:35:31.876453182Z [info] ‚úÖ After processing thornOptions: object Array with 0 items
2025-07-30T19:35:31.876469777Z [info] üîç Processing selectedPassions: object Array with 0 items
2025-07-30T19:35:31.876486059Z [info] ‚úÖ After processing selectedPassions: object Array with 0 items
2025-07-30T19:35:31.876947871Z [info] üîç Processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:31.876962521Z [info] ‚úÖ After processing claimedInnateTreeIds: object Array with 0 items
2025-07-30T19:35:31.876978345Z [info] üîç Processing selfNerfs: object Array with 0 items
2025-07-30T19:35:31.876993893Z [info] ‚úÖ After processing selfNerfs: object Array with 0 items
2025-07-30T19:35:31.877010083Z [info] üîç Processing sharedWith: object Array with 0 items
2025-07-30T19:35:31.877027743Z [info] ‚úÖ After processing sharedWith: object Array with 0 items
2025-07-30T19:35:31.877044886Z [info] üîç Processing factionChanges: object Array with 0 items
2025-07-30T19:35:31.877066654Z [info] ‚úÖ After processing factionChanges: object Array with 0 items
2025-07-30T19:35:31.877082942Z [info] üîç Processing object stats: object
2025-07-30T19:35:31.877100542Z [info] ‚úÖ After processing object stats: object
2025-07-30T19:35:31.877115929Z [info] üîç Processing object skills: object
2025-07-30T19:35:31.877152924Z [info] ‚úÖ After processing object skills: object
2025-07-30T19:35:31.877170303Z [info] üîç Processing object powers: object
2025-07-30T19:35:31.877185437Z [error]     type: 'skill',
2025-07-30T19:35:31.877189463Z [info] ‚úÖ After processing object powers: object
2025-07-30T19:35:31.877207099Z [info] üîç Processing object merits: object
2025-07-30T19:35:31.877211106Z [error]     itemId: 'archery',
2025-07-30T19:35:31.877233972Z [error]     level: 1,
2025-07-30T19:35:31.877252136Z [error]     cost: 2,
2025-07-30T19:35:31.877275174Z [info] ‚úÖ After processing object merits: object
2025-07-30T19:35:31.877277438Z [error]     timestamp: '2025-07-30T19:35:31.925Z',
2025-07-30T19:35:31.877297484Z [info] üìù Directly assigned stats: object
2025-07-30T19:35:31.877300802Z [error]     redundant: false
2025-07-30T19:35:31.877324307Z [info] üìù Directly assigned skills: object
2025-07-30T19:35:31.877324980Z [error]   }" (type Object) at path "advancementHistory"
2025-07-30T19:35:31.877343097Z [info] üìù Directly assigned powers: object
2025-07-30T19:35:31.877349868Z [error]       at SchemaString.cast (/app/node_modules/mongoose/lib/schema/string.js:607:11)
2025-07-30T19:35:31.877357789Z [info] üìù Directly assigned merits: object
2025-07-30T19:35:31.877370942Z [info] üìù Directly assigned lores: Array[0]
2025-07-30T19:35:31.877375906Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.877383051Z [info] üìù Directly assigned xpHistory: Array[1]
2025-07-30T19:35:31.877398132Z [info] üîç Before assignment - character.advancementHistory: Array[0] 
2025-07-30T19:35:31.877401444Z [error]       at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:410:32)
2025-07-30T19:35:31.877425360Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.877446459Z [error]       at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:31.877467563Z [error]       at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:31.877487162Z [error]       at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:31.877505994Z [error]       at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:31.877525455Z [error]       at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:31.877544742Z [error]       at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23) {
2025-07-30T19:35:31.877560097Z [error]     stringValue: '"{\n' +
2025-07-30T19:35:31.877576050Z [error]       '  checkIn: 0,\n' +
2025-07-30T19:35:31.877594648Z [error]       "  type: 'skill',\n" +
2025-07-30T19:35:31.877613412Z [error]       "  itemId: 'archery',\n" +
2025-07-30T19:35:31.877958792Z [info] üîç Value to assign: Array[1]
2025-07-30T19:35:31.877978263Z [info] üßπ Repairing corrupted advancementHistory field in database
2025-07-30T19:35:31.877996376Z [error] Character update error: CastError: Cast to [string] failed for value "[\n' +
2025-07-30T19:35:31.878011636Z [error]   '  {\n' +
2025-07-30T19:35:31.878028556Z [error]   '    checkIn: 0,\n' +
2025-07-30T19:35:31.878043038Z [error]   "    type: 'skill',\n" +
2025-07-30T19:35:31.878058909Z [error]   "    itemId: 'archery',\n" +
2025-07-30T19:35:31.878074728Z [error]   '    level: 1,\n' +
2025-07-30T19:35:31.878223199Z [error]   '    cost: 2,\n' +
2025-07-30T19:35:31.878239161Z [error]   "    timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.878254059Z [error]   '    redundant: false\n' +
2025-07-30T19:35:31.878267698Z [error]   '  }\n' +
2025-07-30T19:35:31.878330037Z [error]   ']" (type string) at path "advancementHistory.0" because of "CastError"
2025-07-30T19:35:31.878349989Z [error]     at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:414:15)
2025-07-30T19:35:31.878366272Z [error]     at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.878383779Z [error]     at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:31.878401886Z [error]     at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:31.880150840Z [error]     at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:31.880185344Z [error]     at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:31.880208173Z [error]     at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:31.880227487Z [error]     at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23)
2025-07-30T19:35:31.880744758Z [error]     at model.Query.exec (/app/node_modules/mongoose/lib/query.js:4604:80)
2025-07-30T19:35:31.880763667Z [error]     at process.processTicksAndRejections (node:internal/process/task_queues:95:5) {
2025-07-30T19:35:31.880782595Z [error]   stringValue: `"[\\n' +\n` +
2025-07-30T19:35:31.880798570Z [error]     "  '  {\\n' +\n" +
2025-07-30T19:35:31.880814332Z [error]     "  '    checkIn: 0,\\n' +\n" +
2025-07-30T19:35:31.880831460Z [error]     `  "    type: 'skill',\\n" +\n` +
2025-07-30T19:35:31.880849349Z [error]     `  "    itemId: 'archery',\\n" +\n` +
2025-07-30T19:35:31.880865227Z [error]     "  '    level: 1,\\n' +\n" +
2025-07-30T19:35:31.880881535Z [error]     "  '    cost: 2,\\n' +\n" +
2025-07-30T19:35:31.880899936Z [error]     `  "    timestamp: '2025-07-30T19:35:31.925Z',\\n" +\n` +
2025-07-30T19:35:31.880917146Z [error]     "  '    redundant: false\\n' +\n" +
2025-07-30T19:35:31.880941039Z [error]     "  '  }\\n' +\n" +
2025-07-30T19:35:31.880956347Z [error]     `  ']"`,
2025-07-30T19:35:31.880972870Z [error]   messageFormat: undefined,
2025-07-30T19:35:31.880998737Z [error]   kind: '[string]',
2025-07-30T19:35:31.881019193Z [error]   value: '[\n' +
2025-07-30T19:35:31.881035950Z [error]     '  {\n' +
2025-07-30T19:35:31.881054430Z [error]     '    checkIn: 0,\n' +
2025-07-30T19:35:31.881070538Z [error]     "    type: 'skill',\n" +
2025-07-30T19:35:31.881086904Z [error]     "    itemId: 'archery',\n" +
2025-07-30T19:35:31.881101776Z [error]     '    level: 1,\n' +
2025-07-30T19:35:31.881116354Z [error]     '    cost: 2,\n' +
2025-07-30T19:35:31.881188572Z [error]     "    timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.881204264Z [error]     '    redundant: false\n' +
2025-07-30T19:35:31.881218029Z [error]     '  }\n' +
2025-07-30T19:35:31.881233942Z [error]     ']',
2025-07-30T19:35:31.881251900Z [error]   path: 'advancementHistory.0',
2025-07-30T19:35:31.881793357Z [error]   reason: CastError: Cast to string failed for value "{
2025-07-30T19:35:31.881809282Z [error]     checkIn: 0,
2025-07-30T19:35:31.881824091Z [error]     type: 'skill',
2025-07-30T19:35:31.881843545Z [error]     itemId: 'archery',
2025-07-30T19:35:31.881858778Z [error]     level: 1,
2025-07-30T19:35:31.881872858Z [error]     cost: 2,
2025-07-30T19:35:31.881886294Z [error]     timestamp: '2025-07-30T19:35:31.925Z',
2025-07-30T19:35:31.881898478Z [error]     redundant: false
2025-07-30T19:35:31.881911920Z [error]   }" (type Object) at path "advancementHistory"
2025-07-30T19:35:31.881925587Z [error]       at SchemaString.cast (/app/node_modules/mongoose/lib/schema/string.js:607:11)
2025-07-30T19:35:31.881938332Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.881950620Z [error]       at SchemaArray.cast (/app/node_modules/mongoose/lib/schema/array.js:410:32)
2025-07-30T19:35:31.881963580Z [error]       at SchemaType.applySetters (/app/node_modules/mongoose/lib/schemaType.js:1258:12)
2025-07-30T19:35:31.881980839Z [error]       at castUpdateVal (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:626:21)
2025-07-30T19:35:31.881994619Z [error]       at walkUpdatePath (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:433:24)
2025-07-30T19:35:31.882009669Z [error]       at castUpdate (/app/node_modules/mongoose/lib/helpers/query/castUpdate.js:144:7)
2025-07-30T19:35:31.882026843Z [error]       at model.Query._castUpdate (/app/node_modules/mongoose/lib/query.js:4851:10)
2025-07-30T19:35:31.882043895Z [error]       at model.Query._updateThunk (/app/node_modules/mongoose/lib/query.js:4039:25)
2025-07-30T19:35:31.882062410Z [error]       at model.Query._updateOne (/app/node_modules/mongoose/lib/query.js:4127:23) {
2025-07-30T19:35:31.882076064Z [error]     stringValue: '"{\n' +
2025-07-30T19:35:31.882089030Z [error]       '  checkIn: 0,\n' +
2025-07-30T19:35:31.882537750Z [error]       "  type: 'skill',\n" +
2025-07-30T19:35:31.882554029Z [error]       "  itemId: 'archery',\n" +
2025-07-30T19:35:31.882569785Z [error]       '  level: 1,\n' +
2025-07-30T19:35:31.882585309Z [error]       '  cost: 2,\n' +
2025-07-30T19:35:31.882601842Z [error]       "  timestamp: '2025-07-30T19:35:31.925Z',\n" +
2025-07-30T19:35:31.882617535Z [error]       '  redundant: false\n' +
2025-07-30T19:35:31.882635020Z [error]       '}"',
2025-07-30T19:35:31.882649214Z [error]     messageFormat: undefined,
2025-07-30T19:35:31.882661261Z [error]     kind: 'string',
2025-07-30T19:35:31.882737959Z [error]     value: {
2025-07-30T19:35:31.882755374Z [error]       checkIn: 0,
2025-07-30T19:35:31.882770404Z [error]       type: 'skill',
2025-07-30T19:35:31.882785938Z [error]       itemId: 'archery',
2025-07-30T19:35:31.882801099Z [error]       level: 1,
2025-07-30T19:35:31.882817479Z [error]       cost: 2,
2025-07-30T19:35:31.882834656Z [error]       timestamp: '2025-07-30T19:35:31.925Z',
2025-07-30T19:35:31.882851081Z [error]       redundant: false
2025-07-30T19:35:31.882865589Z [error]     },
2025-07-30T19:35:31.882881497Z [error]     path: 'advancementHistory',
2025-07-30T19:35:31.882896926Z [error]     reason: null,
2025-07-30T19:35:31.882926271Z [error]     valueType: 'Object'
2025-07-30T19:35:31.882943681Z [error]   },
2025-07-30T19:35:31.882958952Z [error]   valueType: 'string'
2025-07-30T19:35:31.882973821Z [error] }
2025-07-30T19:35:31.883003585Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:30 +0000] "PUT /api/characters/688a73fe54a32f443d2c4f3b HTTP/1.1" 500 61 "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:31.883021806Z [info] Character update request: {
2025-07-30T19:35:31.883038996Z [info]   characterId: '688a73fe54a32f443d2c4f3b',
2025-07-30T19:35:34.491977078Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:34 +0000] "GET /api/characters HTTP/1.1" 200 - "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"
2025-07-30T19:35:34.610647676Z [info] 50.47.84.24 - - [30/Jul/2025:19:35:34 +0000] "GET /api/characters HTTP/1.1" 304 - "https://shadowaccordcharacterbuilder.up.railway.app/" "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Mobile Safari/537.36"